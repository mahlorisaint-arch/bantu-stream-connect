<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
<title>Creator Channel - Bantu Stream Connect</title>
<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Supabase JS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- Swiper JS for carousels -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<!-- CSS Files from content library -->
<link rel="stylesheet" href="css/content-library-themes.css">
<link rel="stylesheet" href="css/content-library-features.css">
<style>
/* Base styles merged from explore-screen and content-library */
:root {
--deep-black: #0A0E12;
--deep-navy: #0F172A;
--soft-white: #F8FAFC;
--slate-grey: #94A3B8;
--bantu-blue: #1D4ED8;
--warm-gold: #F59E0B;
--error-color: #EF4444;
--success-color: #10B981;
--glow-cycle-1: #00A3FF;
--glow-cycle-2: #0066FF;
--glow-cycle-3: #8B5CF6;
--glow-cycle-4: #EC4899;
--card-bg: rgba(15, 23, 42, 0.6);
--card-border: rgba(148, 163, 184, 0.2);
--hover-overlay: rgba(255, 255, 255, 0.05);
--active-overlay: rgba(245, 158, 11, 0.1);
--indigo: #4F46E5;
--gold-glow: rgba(245, 158, 11, 0.3);
--blue-glow: rgba(29, 78, 216, 0.3);
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Inter', sans-serif;
background: var(--deep-black);
color: var(--soft-white);
min-height: 100vh;
overflow-x: hidden;
transition: background-color 0.3s ease, color 0.3s ease;
}
/* Loading Screen */
.loading-screen {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: var(--deep-black);
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
z-index: 1000;
}
.spinner {
width: 50px;
height: 50px;
border: 3px solid rgba(255, 255, 255, 0.1);
border-radius: 50%;
border-top-color: var(--bantu-blue);
animation: spin 1s linear infinite;
margin-bottom: 20px;
}
@keyframes spin {
to { transform: rotate(360deg); }
}
/* Animated Background */
.animated-bg {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 1;
overflow: hidden;
}
.glow-cycle {
position: absolute;
border-radius: 50%;
filter: blur(60px);
opacity: 0.1;
animation: float 8s infinite ease-in-out;
}
.glow-1 {
width: 400px;
height: 400px;
background: var(--glow-cycle-1);
top: 10%;
left: 5%;
animation-delay: 0s;
}
.glow-2 {
width: 300px;
height: 300px;
background: var(--glow-cycle-2);
top: 60%;
right: 10%;
animation-delay: 2s;
}
.glow-3 {
width: 350px;
height: 350px;
background: var(--glow-cycle-3);
bottom: 10%;
left: 20%;
animation-delay: 4s;
}
.glow-4 {
width: 250px;
height: 250px;
background: var(--glow-cycle-4);
top: 20%;
right: 20%;
animation-delay: 6s;
}
@keyframes float {
0%, 100% { transform: translateY(0) scale(1); }
50% { transform: translateY(-20px) scale(1.05); }
}
/* Channel Banner - TIER 1 FEATURE */
.channel-banner {
height: 280px;
border-radius: 20px;
overflow: hidden;
margin-bottom: -60px;
position: relative;
background: linear-gradient(rgba(10, 14, 18, 0.85), rgba(15, 23, 42, 0.95)), 
            url('https://images.unsplash.com/photo-1517604931442-7e0c8ed2963c?w=1500&h=400&fit=crop') center/cover;
display: flex;
align-items: flex-end;
padding: 0 40px 30px;
}
.channel-banner::after {
content: '';
position: absolute;
bottom: 0;
left: 0;
right: 0;
height: 60%;
background: linear-gradient(to top, var(--deep-black), transparent);
}
.banner-title {
font-family: 'Orbitron', sans-serif;
font-size: 32px;
font-weight: 700;
color: white;
text-shadow: 0 2px 15px rgba(0, 0, 0, 0.7);
z-index: 2;
background: linear-gradient(135deg, var(--soft-white), var(--warm-gold));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
letter-spacing: 1px;
}
/* Main Container */
.container {
max-width: 1200px;
margin: 0 auto;
padding: 24px;
position: relative;
z-index: 2;
padding-bottom: 100px;
}
/* Header */
.header {
background: rgba(10, 14, 18, 0.9);
backdrop-filter: blur(20px);
padding: 12px 24px;
position: sticky;
top: 0;
z-index: 100;
border-bottom: 1px solid var(--card-border);
display: flex;
justify-content: space-between;
align-items: center;
min-height: 60px;
}
.logo {
display: flex;
align-items: center;
gap: 12px;
cursor: pointer;
text-decoration: none;
}
.logo-icon {
width: 40px;
height: 40px;
border-radius: 10px;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 0 32px rgba(29, 78, 216, 0.3);
background: transparent;
border: 1px solid rgba(255, 255, 255, 0.1);
}
.logo-text {
font-family: 'Orbitron', sans-serif;
font-weight: 700;
font-size: 17px;
background: linear-gradient(to right, var(--soft-white), var(--bantu-blue));
-webkit-background-clip: text;
background-clip: text;
color: transparent;
letter-spacing: 0.5px;
}
.header-actions {
display: flex;
gap: 10px;
align-items: center;
}
.icon-btn {
width: 38px;
height: 38px;
border-radius: 50%;
background: rgba(255, 255, 255, 0.1);
border: 1px solid rgba(255, 255, 255, 0.2);
color: var(--soft-white);
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s ease;
position: relative;
}
.icon-btn:hover {
background: rgba(255, 255, 255, 0.2);
transform: translateY(-2px);
}
.notification-badge {
position: absolute;
top: -5px;
right: -5px;
background: var(--error-color);
color: white;
font-size: 10px;
font-weight: bold;
width: 18px;
height: 18px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
border: 2px solid var(--deep-black);
}
.profile-btn {
width: 38px;
height: 38px;
border-radius: 50%;
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
border: 2px solid rgba(255, 255, 255, 0.2);
cursor: pointer;
overflow: hidden;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: 600;
font-size: 14px;
}
.profile-btn:hover {
transform: translateY(-2px);
box-shadow: 0 8px 20px rgba(29, 78, 216, 0.3);
}
.profile-img {
width: 100%;
height: 100%;
object-fit: cover;
}
.profile-placeholder {
width: 100%;
height: 100%;
display: flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
color: white;
font-size: 14px;
}
/* Creator Header Section - PERFECT CIRCLE AVATAR */
.creator-header {
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 24px;
padding: 40px;
margin-bottom: 30px;
margin-top: 60px; /* Compensate for banner overlap */
backdrop-filter: blur(10px);
box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
position: relative;
overflow: hidden;
border-top: 2px solid var(--warm-gold);
}
.creator-header::before {
content: '';
position: absolute;
top: -2px;
left: -2px;
right: -2px;
bottom: -2px;
background: linear-gradient(45deg, var(--warm-gold), var(--bantu-blue), var(--warm-gold));
border-radius: 26px;
z-index: -1;
opacity: 0.1;
animation: pulse-glow 3s infinite alternate;
}
@keyframes pulse-glow {
0% { opacity: 0.1; }
100% { opacity: 0.3; }
}
.creator-info {
display: flex;
align-items: center;
gap: 30px;
position: relative;
z-index: 1;
}
@media (max-width: 768px) {
.creator-info {
flex-direction: column;
text-align: center;
gap: 20px;
}
}
.creator-avatar-container {
position: relative;
width: 130px;
height: 130px;
}
.creator-avatar {
width: 100%;
height: 100%;
border-radius: 50%;
overflow: hidden;
border: 4px solid var(--warm-gold);
box-shadow: 0 0 25px rgba(245, 158, 11, 0.4);
display: flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
flex-shrink: 0;
}
.creator-avatar img {
width: 100%;
height: 100%;
object-fit: cover;
display: block;
border-radius: 50%;
}
.creator-initials {
width: 100%;
height: 100%;
display: flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
color: white;
font-size: 48px;
font-weight: bold;
border-radius: 50%;
}
.founder-badge {
position: absolute;
top: -10px;
right: -10px;
background: linear-gradient(135deg, var(--warm-gold), #f97316);
color: var(--deep-black);
padding: 5px 15px;
border-radius: 20px;
font-size: 12px;
font-weight: bold;
box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
z-index: 2;
}
.creator-details {
flex: 1;
}
.creator-name {
font-family: 'Orbitron', sans-serif;
font-size: 32px;
font-weight: 700;
margin-bottom: 10px;
background: linear-gradient(135deg, var(--soft-white), var(--warm-gold));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}
.creator-username {
font-size: 18px;
color: var(--slate-grey);
margin-bottom: 20px;
}
.creator-bio {
font-size: 16px;
line-height: 1.6;
color: rgba(248, 250, 252, 0.8);
margin-bottom: 20px;
min-height: 60px;
display: -webkit-box;
-webkit-line-clamp: 3;
-webkit-box-orient: vertical;
overflow: hidden;
}
/* About Section - TIER 1 FEATURE */
.about-section {
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 20px;
padding: 30px;
margin-bottom: 30px;
backdrop-filter: blur(10px);
}
.about-title {
font-family: 'Orbitron', sans-serif;
font-size: 24px;
margin-bottom: 20px;
display: flex;
align-items: center;
gap: 10px;
color: var(--soft-white);
}
.about-content {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 25px;
}
@media (max-width: 768px) {
.about-content {
grid-template-columns: 1fr;
}
}
.about-item {
display: flex;
align-items: flex-start;
gap: 12px;
padding: 12px;
border-radius: 12px;
background: rgba(255, 255, 255, 0.03);
transition: all 0.3s ease;
}
.about-item:hover {
background: rgba(245, 158, 11, 0.1);
transform: translateX(5px);
}
.about-item i {
font-size: 18px;
color: var(--warm-gold);
min-width: 24px;
}
.about-item span, .about-item a {
color: var(--soft-white);
text-decoration: none;
font-size: 16px;
}
.about-item a:hover {
color: var(--warm-gold);
text-decoration: underline;
}
.full-bio {
grid-column: 1 / -1;
line-height: 1.7;
font-size: 16px;
color: rgba(248, 250, 252, 0.9);
}
/* Stats Section */
.stats-section {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 20px;
margin-bottom: 30px;
}
@media (max-width: 768px) {
.stats-section {
grid-template-columns: 1fr;
}
}
.stat-card {
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 20px;
padding: 25px;
text-align: center;
transition: all 0.3s ease;
backdrop-filter: blur(10px);
}
.stat-card:hover {
transform: translateY(-5px);
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
border-color: rgba(245, 158, 11, 0.3);
}
.stat-number {
font-family: 'Orbitron', sans-serif;
font-size: 32px;
font-weight: 700;
color: var(--warm-gold);
margin-bottom: 10px;
}
.stat-label {
font-size: 16px;
color: var(--slate-grey);
}
/* Action Buttons */
.action-buttons {
display: flex;
gap: 20px;
margin-bottom: 40px;
}
@media (max-width: 768px) {
.action-buttons {
flex-direction: column;
}
}
.action-btn {
flex: 1;
padding: 18px;
border-radius: 12px;
font-size: 16px;
font-weight: 600;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
transition: all 0.3s ease;
border: none;
backdrop-filter: blur(10px);
}
.connect-btn {
background: linear-gradient(135deg, var(--warm-gold), var(--bantu-blue));
color: var(--soft-white);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.connect-btn:hover:not(:disabled) {
transform: translateY(-3px);
box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4);
}
.connected-btn {
background: linear-gradient(135deg, var(--success-color), #059669);
color: white;
border: 1px solid rgba(255, 255, 255, 0.1);
}
.connected-btn:hover:not(:disabled) {
transform: translateY(-3px);
box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
}
.share-btn {
background: var(--card-bg);
border: 1px solid var(--card-border);
color: var(--soft-white);
}
.share-btn:hover:not(:disabled) {
background: rgba(255, 255, 255, 0.1);
transform: translateY(-3px);
border-color: var(--warm-gold);
}
.action-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}
/* Content Sections */
.section {
margin-bottom: 40px;
}
.section-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
}
.section-title {
font-family: 'Orbitron', sans-serif;
font-size: 24px;
font-weight: 700;
background: linear-gradient(135deg, var(--soft-white), var(--warm-gold));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
display: flex;
align-items: center;
gap: 10px;
}
.content-count {
font-size: 14px;
color: var(--slate-grey);
}
/* Content Grid */
.content-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 20px;
}
@media (max-width: 768px) {
.content-grid {
grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
}
}
@media (max-width: 480px) {
.content-grid {
grid-template-columns: repeat(2, 1fr);
}
}
/* Content Card */
.content-card {
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 20px;
overflow: hidden;
transition: all 0.3s ease;
cursor: pointer;
text-decoration: none;
color: inherit;
backdrop-filter: blur(10px);
position: relative;
}
.content-card:hover {
transform: translateY(-8px);
box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
border-color: rgba(245, 158, 11, 0.3);
}
.card-thumbnail {
position: relative;
height: 140px;
overflow: hidden;
}
.card-thumbnail img {
width: 100%;
height: 100%;
object-fit: cover;
transition: transform 0.3s ease;
}
.content-card:hover .card-thumbnail img {
transform: scale(1.05);
}
.thumbnail-overlay {
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: linear-gradient(to bottom, transparent 50%, rgba(0, 0, 0, 0.5) 100%);
}
.play-overlay {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.5);
display: flex;
align-items: center;
justify-content: center;
opacity: 0;
transition: opacity 0.3s ease;
}
.content-card:hover .play-overlay {
opacity: 1;
}
.play-icon {
width: 50px;
height: 50px;
background: rgba(245, 158, 11, 0.9);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
color: var(--deep-black);
font-size: 1.5rem;
transform: scale(0.8);
transition: all 0.3s ease;
}
.content-card:hover .play-icon {
transform: scale(1);
}
.card-badges {
position: absolute;
top: 10px;
left: 10px;
display: flex;
gap: 0.5rem;
z-index: 2;
}
.card-badge {
padding: 4px 12px;
background: rgba(0, 0, 0, 0.7);
border-radius: 12px;
color: var(--soft-white);
font-size: 11px;
font-weight: 600;
display: flex;
align-items: center;
gap: 4px;
backdrop-filter: blur(4px);
}
.badge-trending {
background: rgba(245, 158, 11, 0.9);
}
.badge-new {
background: rgba(29, 78, 216, 0.9);
}
.badge-live {
background: rgba(239, 68, 68, 0.9);
}
.card-content {
padding: 15px;
}
.card-title {
font-size: 16px;
font-weight: 600;
margin-bottom: 10px;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
overflow: hidden;
min-height: 40px;
color: var(--soft-white);
line-height: 1.4;
}
.creator-info {
display: flex;
align-items: center;
gap: 10px;
margin-bottom: 10px;
}
.creator-avatar-small {
width: 30px;
height: 30px;
border-radius: 50%;
overflow: hidden;
display: flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
color: white;
font-weight: bold;
font-size: 12px;
flex-shrink: 0;
}
.creator-avatar-small img {
width: 100%;
height: 100%;
object-fit: cover;
}
.creator-name-small {
font-size: 14px;
color: var(--slate-grey);
}
.creator-btn {
background: linear-gradient(135deg, var(--bantu-blue), var(--warm-gold));
color: var(--soft-white);
border: none;
padding: 8px 15px;
border-radius: 10px;
font-size: 12px;
font-weight: 500;
cursor: pointer;
display: inline-flex;
align-items: center;
gap: 5px;
transition: all 0.3s ease;
border: 1px solid rgba(255, 255, 255, 0.1);
margin-bottom: 10px;
}
.creator-btn:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(29, 78, 216, 0.4);
}
.card-stats {
display: flex;
gap: 15px;
margin-top: 8px;
font-size: 12px;
color: var(--slate-grey);
}
.card-stat {
display: flex;
align-items: center;
gap: 4px;
}
.card-stat i {
color: var(--bantu-blue);
font-size: 12px;
}
.card-meta {
display: flex;
justify-content: space-between;
font-size: 12px;
color: var(--slate-grey);
}
/* Empty State */
.empty-state {
text-align: center;
padding: 60px 20px;
color: var(--slate-grey);
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 16px;
backdrop-filter: blur(10px);
}
.empty-icon {
font-size: 48px;
margin-bottom: 20px;
color: var(--warm-gold);
opacity: 0.5;
}
/* Footer */
.footer {
background: var(--card-bg);
border-top: 1px solid var(--card-border);
padding: 30px 20px;
margin-top: 50px;
backdrop-filter: blur(10px);
position: relative;
z-index: 2;
}
.footer p {
text-align: center;
color: var(--slate-grey);
margin-bottom: 15px;
font-size: 14px;
}
.footer-links {
display: flex;
justify-content: center;
gap: 20px;
flex-wrap: wrap;
}
.footer-links a {
color: var(--slate-grey);
text-decoration: none;
transition: color 0.3s ease;
font-size: 14px;
}
.footer-links a:hover {
color: var(--warm-gold);
}
.footer-contact {
margin-top: 20px;
font-size: 14px;
color: var(--slate-grey);
text-align: center;
}
.footer-contact a {
color: var(--warm-gold);
text-decoration: none;
}
.footer-contact a:hover {
text-decoration: underline;
}
/* Toast Container */
#toast-container {
position: fixed;
bottom: 20px;
right: 20px;
z-index: 9999;
display: flex;
flex-direction: column;
gap: 10px;
}
.toast {
padding: 15px 25px;
border-radius: 12px;
color: var(--soft-white);
font-weight: 500;
animation: slideIn 0.3s ease;
max-width: 300px;
backdrop-filter: blur(10px);
border: 1px solid var(--card-border);
display: flex;
align-items: center;
gap: 10px;
box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}
.toast i {
font-size: 18px;
}
.toast.error {
background: rgba(239, 68, 68, 0.9);
}
.toast.success {
background: rgba(16, 185, 129, 0.9);
}
.toast.warning {
background: rgba(245, 158, 11, 0.9);
}
.toast.info {
background: var(--card-bg);
border: 1px solid var(--card-border);
}
@keyframes slideIn {
from {
transform: translateX(100%);
opacity: 0;
}
to {
transform: translateX(0);
opacity: 1;
}
}
/* Modals */
.modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.8);
display: none;
align-items: center;
justify-content: center;
z-index: 2000;
backdrop-filter: blur(5px);
}
.modal.active {
display: flex;
}
.modal-content {
background: var(--card-bg);
border: 1px solid var(--card-border);
border-radius: 20px;
padding: 40px;
max-width: 500px;
width: 90%;
max-height: 80vh;
overflow-y: auto;
backdrop-filter: blur(10px);
}
.modal-title {
font-family: 'Orbitron', sans-serif;
font-size: 24px;
margin-bottom: 20px;
color: var(--soft-white);
text-align: center;
background: linear-gradient(135deg, var(--soft-white), var(--warm-gold));
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}
.connectors-list {
max-height: 50vh;
overflow-y: auto;
margin-bottom: 20px;
}
.connector-item {
display: flex;
align-items: center;
gap: 15px;
padding: 15px;
background: rgba(255, 255, 255, 0.05);
border-radius: 10px;
margin-bottom: 10px;
border: 1px solid var(--card-border);
}
.connector-avatar {
width: 40px;
height: 40px;
border-radius: 50%;
overflow: hidden;
border: 2px solid var(--warm-gold);
}
.connector-avatar img {
width: 100%;
height: 100%;
object-fit: cover;
}
.connector-info {
flex: 1;
}
.connector-name {
font-weight: 600;
margin-bottom: 5px;
color: var(--soft-white);
}
.connector-username {
font-size: 14px;
color: var(--slate-grey);
}
.modal-actions {
display: flex;
gap: 15px;
}
.modal-btn {
flex: 1;
padding: 12px;
border-radius: 10px;
border: none;
font-size: 16px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
}
.modal-btn.close {
background: linear-gradient(135deg, var(--warm-gold), var(--bantu-blue));
color: var(--soft-white);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.modal-btn.close:hover {
transform: translateY(-2px);
box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
}
/* Search Modal */
.search-modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.9);
display: none;
align-items: center;
justify-content: center;
z-index: 2000;
backdrop-filter: blur(5px);
}
.search-modal.active {
display: flex;
}
.search-modal-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
padding-bottom: 15px;
border-bottom: 1px solid var(--card-border);
width: 100%;
}
.search-input-container {
position: relative;
width: 100%;
max-width: 600px;
}
.search-icon {
position: absolute;
left: 15px;
top: 50%;
transform: translateY(-50%);
color: var(--slate-grey);
font-size: 18px;
}
.search-input {
width: 100%;
padding: 15px 15px 15px 45px;
border-radius: 12px;
border: 1px solid var(--card-border);
background: var(--card-bg);
color: var(--soft-white);
font-size: 16px;
backdrop-filter: blur(10px);
}
.search-input::placeholder {
color: var(--slate-grey);
}
.search-input:focus {
outline: none;
border-color: var(--warm-gold);
box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.2);
}
.close-search-btn {
background: none;
border: none;
color: var(--soft-white);
font-size: 24px;
cursor: pointer;
width: 40px;
height: 40px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.3s ease;
}
.close-search-btn:hover {
background: rgba(255, 255, 255, 0.1);
transform: rotate(90deg);
}
.search-filters {
display: flex;
gap: 15px;
margin-bottom: 20px;
width: 100%;
max-width: 600px;
}
.filter-group {
flex: 1;
}
.filter-label {
display: block;
margin-bottom: 8px;
font-size: 14px;
color: var(--slate-grey);
}
.filter-select {
width: 100%;
padding: 12px;
border-radius: 10px;
border: 1px solid var(--card-border);
background: var(--card-bg);
color: var(--soft-white);
font-size: 14px;
backdrop-filter: blur(10px);
}
.search-results {
width: 100%;
max-width: 800px;
max-height: 70vh;
overflow-y: auto;
}
.search-results-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 15px;
}
/* Custom Scrollbar */
::-webkit-scrollbar {
width: 8px;
height: 8px;
}
::-webkit-scrollbar-track {
background: var(--deep-navy);
}
::-webkit-scrollbar-thumb {
background: var(--bantu-blue);
border-radius: 4px;
}
::-webkit-scrollbar-thumb:hover {
background: var(--warm-gold);
}
/* Responsive */
@media (max-width: 768px) {
.container {
padding: 16px;
padding-bottom: 130px;
}
.channel-banner {
height: 200px;
padding: 0 20px 20px;
margin-bottom: -40px;
}
.banner-title {
font-size: 24px;
}
.creator-header {
padding: 30px 20px;
margin-top: 40px;
}
.creator-avatar-container {
width: 110px;
height: 110px;
}
.creator-name {
font-size: 28px;
}
.creator-username {
font-size: 16px;
}
.stat-number {
font-size: 28px;
}
.action-buttons {
gap: 15px;
}
.action-btn {
padding: 15px;
font-size: 15px;
}
.section-header {
flex-direction: column;
align-items: flex-start;
gap: 10px;
}
.search-filters {
flex-direction: column;
}
}
@media (max-width: 480px) {
.channel-banner {
height: 160px;
padding: 0 15px 15px;
margin-bottom: -30px;
}
.banner-title {
font-size: 20px;
}
.creator-avatar-container {
width: 100px;
height: 100px;
}
.creator-initials {
font-size: 40px;
}
.creator-name {
font-size: 24px;
}
.stat-number {
font-size: 24px;
}
.stat-label {
font-size: 14px;
}
.action-btn {
padding: 14px;
font-size: 14px;
}
.content-grid {
grid-template-columns: repeat(2, 1fr);
}
.header {
padding: 8px 14px;
min-height: 48px;
}
.logo-icon {
width: 30px;
height: 30px;
}
.logo-text {
font-size: 14px;
max-width: 130px;
}
.icon-btn, .profile-btn {
width: 34px;
height: 34px;
}
.search-input {
padding: 12px 12px 12px 40px;
font-size: 14px;
}
}
/* Accessibility & Touch Targets */
@media (hover: none) and (pointer: coarse) {
.icon-btn, .profile-btn, .nav-icon, .creator-btn, .action-btn {
min-width: 44px !important;
min-height: 44px !important;
}
.header, .navigation-button, .footer {
-webkit-tap-highlight-color: transparent;
user-select: none;
}
}
</style>
</head>
<body>
<!-- Loading Screen -->
<div id="loading" class="loading-screen">
<div class="spinner"></div>
<div id="loading-text">Loading Creator Channel...</div>
</div>
<!-- Animated Background -->
<div class="animated-bg">
<div class="glow-cycle glow-1"></div>
<div class="glow-cycle glow-2"></div>
<div class="glow-cycle glow-3"></div>
<div class="glow-cycle glow-4"></div>
</div>
<!-- Connectors Modal -->
<div id="connectors-modal" class="modal">
<div class="modal-content">
<h2 class="modal-title" id="modal-title">Connectors (0)</h2>
<div id="connectors-list" class="connectors-list">
<!-- Connectors will be loaded here -->
</div>
<div class="modal-actions">
<button id="close-modal-btn" class="modal-btn close">Close</button>
</div>
</div>
</div>
<!-- Search Modal -->
<div id="search-modal" class="search-modal">
<div style="width: 90%; max-width: 800px; background: var(--card-bg); border-radius: 20px; padding: 30px; backdrop-filter: blur(10px);">
<div class="search-modal-header">
<div class="search-input-container">
<i class="search-icon fas fa-search"></i>
<input type="text" id="search-input" class="search-input" placeholder="Search content, creators, or categories..." autocomplete="off">
</div>
<button id="close-search-btn" class="close-search-btn">
<i class="fas fa-times"></i>
</button>
</div>
<div class="search-filters">
<div class="filter-group">
<label class="filter-label">Category</label>
<select id="category-filter" class="filter-select">
<option value="">All Categories</option>
<option value="Music">Music</option>
<option value="STEM">STEM</option>
<option value="Culture">Culture</option>
<option value="News">News</option>
<option value="Sports">Sports</option>
<option value="Movies">Movies</option>
<option value="Documentaries">Documentaries</option>
<option value="Podcasts">Podcasts</option>
</select>
</div>
<div class="filter-group">
<label class="filter-label">Sort By</label>
<select id="sort-filter" class="filter-select">
<option value="newest">Newest First</option>
<option value="popular">Most Popular</option>
<option value="trending">Trending</option>
</select>
</div>
</div>
<div class="search-results">
<div id="search-results-grid" class="search-results-grid">
<!-- Results loaded here -->
</div>
</div>
</div>
</div>
<!-- Main Content (hidden until loaded) -->
<div id="app" style="display: none;">
<!-- Header -->
<header class="header">
<div class="logo" onclick="window.location.href='index.html'">
<div class="logo-icon">
<i class="fas fa-film" style="color: var(--warm-gold); font-size: 20px;"></i>
</div>
<div class="logo-text">BANTU STREAM CONNECT</div>
</div>
<div class="header-actions">
<!-- Search Button -->
<button id="search-btn" class="icon-btn search-btn" title="Search">
<i class="fas fa-search"></i>
</button>
<!-- Notifications Button -->
<button id="notifications-btn" class="icon-btn" title="Notifications">
<i class="fas fa-bell"></i>
<span class="notification-badge" id="notification-count" style="display: none;">0</span>
</button>
<!-- Profile Button -->
<button id="profile-btn" class="profile-btn" title="Profile">
<div class="profile-placeholder" id="userProfilePlaceholder">
<i class="fas fa-user"></i>
</div>
</button>
</div>
</header>

<!-- Channel Banner - TIER 1 FEATURE -->
<div class="channel-banner" id="channel-banner">
<div class="banner-title" id="banner-title">OFFICIAL CHANNEL</div>
</div>

<!-- Main Content -->
<main class="container">
<!-- Creator Header -->
<section id="creator-header" class="creator-header">
<div class="creator-info">
<div class="creator-avatar-container">
<div class="creator-avatar" id="creator-avatar-container">
<!-- Avatar or initials will be loaded here -->
</div>
<div id="founder-badge" class="founder-badge" style="display: none;">FOUNDER</div>
</div>
<div class="creator-details">
<h1 id="creator-name" class="creator-name">Creator Name</h1>
<div id="creator-username" class="creator-username">@username</div>
<div id="creator-bio" class="creator-bio">Creator bio will appear here</div>
</div>
</div>
</section>

<!-- About Section - TIER 1 FEATURE -->
<section class="about-section">
<h2 class="about-title">
<i class="fas fa-info-circle"></i>
About
</h2>
<div class="about-content">
<div class="full-bio" id="full-bio">Full bio will appear here</div>
<div class="about-item">
<i class="fas fa-map-marker-alt"></i>
<span id="location">Johannesburg, South Africa</span>
</div>
<div class="about-item">
<i class="fas fa-calendar"></i>
<span id="joined-date">Joined February 2025</span>
</div>
<div class="about-item">
<i class="fas fa-link"></i>
<a id="website-link" href="#" target="_blank">Website</a>
</div>
<div class="about-item">
<i class="fas fa-tags"></i>
<span id="interests">#Afrobeats #Tech #Culture</span>
</div>
</div>
</section>

<!-- Stats Section -->
<section class="stats-section">
<div class="stat-card">
<div id="videos-count" class="stat-number">0</div>
<div class="stat-label">Videos</div>
</div>
<div class="stat-card" id="connectors-stat-card">
<div id="connectors-count" class="stat-number">0</div>
<div class="stat-label">Connectors</div>
</div>
<div class="stat-card">
<div id="uploads-count" class="stat-number">0</div>
<div class="stat-label">Uploads</div>
</div>
</section>

<!-- Action Buttons -->
<section class="action-buttons">
<button id="connect-btn" class="action-btn connect-btn">
<i class="fas fa-link"></i>
<span id="connect-text">Connect</span>
</button>
<button id="share-btn" class="action-btn share-btn">
<i class="fas fa-share"></i>
Share Channel
</button>
</section>

<!-- Uploads Section (SINGLE SECTION) -->
<section class="section">
<div class="section-header">
<h2 class="section-title">
<i class="fas fa-video" style="color: var(--bantu-blue);"></i>
UPLOADS
</h2>
<div id="content-count" class="content-count">0 items</div>
</div>
<div class="content-grid" id="content-grid">
<!-- All creator content will be loaded here -->
</div>
<div id="no-content" class="empty-state" style="display: none; grid-column: 1 / -1;">
<div class="empty-icon">
<i class="fas fa-video-slash"></i>
</div>
<h3>No Uploads Yet</h3>
<p>This creator hasn't uploaded any content</p>
</div>
</section>
</main>

<!-- Footer -->
<footer class="footer">
<p>Bantu Stream Connect Â© 2025 â€¢ Built in South Africa â€¢ NO DNA, JUST RSA</p>
<div class="footer-links">
<a href="privacy-policy.html">Privacy Policy</a>
<a href="terms-of-service.html">Terms of Service</a>
<a href="support.html">Support</a>
</div>
<div class="footer-contact">
Need help? Contact us at <a href="mailto:support@bantustreamconnect.com">support@bantustreamconnect.com</a>
</div>
</footer>

<!-- Global Navigation -->
<div class="navigation-button-container">
<div class="navigation-button">
<div class="nav-icon" id="nav-home-btn" title="Home">
<i class="fas fa-home"></i>
</div>
<div class="nav-icon" id="nav-theme-toggle" title="Change Theme">
<i class="fas fa-palette"></i>
</div>
<div class="nav-icon" id="nav-create-btn" title="Create Content">
<i class="fas fa-plus-circle"></i>
</div>
<div class="nav-icon" id="nav-dashboard-btn" title="Creator Dashboard">
<i class="fas fa-tachometer-alt"></i>
</div>
<div class="nav-icon" id="nav-notifications-btn" title="Notifications">
<i class="fas fa-bell"></i>
<span class="nav-notification-badge" id="nav-notification-count" style="display: none;">0</span>
</div>
</div>
</div>

<!-- Toast Container -->
<div id="toast-container"></div>

<!-- Back to Top Button -->
<button id="backToTopBtn" class="back-to-top">
<i class="fas fa-arrow-up"></i>
</button>
</div>

<!-- Notifications Panel -->
<div id="notifications-panel" class="modal">
<div class="modal-content">
<div class="notifications-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
<h2 style="font-family: 'Orbitron', sans-serif; font-size: 24px; margin: 0; color: var(--soft-white);">Notifications</h2>
<button id="close-notifications" class="close-search-btn">
<i class="fas fa-times"></i>
</button>
</div>
<div class="notifications-list" id="notifications-list" style="max-height: 60vh; overflow-y: auto;">
<!-- Notifications loaded here -->
</div>
<div class="notifications-footer" style="display: flex; gap: 15px; margin-top: 20px;">
<button id="mark-all-read" class="modal-btn close" style="flex: 1;">Mark all as read</button>
<button id="notification-settings" class="modal-btn close" style="flex: 1; background: var(--card-bg); border-color: var(--card-border);">Settings</button>
</div>
</div>
</div>

<!-- Theme Selector -->
<div id="theme-selector" class="modal" style="display: none; background: rgba(0,0,0,0.5);">
<div style="background: var(--card-bg); border-radius: 20px; padding: 20px; max-width: 400px; width: 90%;">
<div style="font-family: 'Orbitron', sans-serif; font-size: 20px; margin-bottom: 15px; text-align: center; color: var(--soft-white);">Choose Theme</div>
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
<button class="theme-option" data-theme="dark" style="padding: 15px; border-radius: 12px; border: 1px solid var(--card-border); background: #1e293b; color: white; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
<i class="fas fa-moon"></i> Dark
</button>
<button class="theme-option" data-theme="light" style="padding: 15px; border-radius: 12px; border: 1px solid var(--card-border); background: #f8fafc; color: #0f172a; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
<i class="fas fa-sun"></i> Light
</button>
<button class="theme-option" data-theme="high-contrast" style="padding: 15px; border-radius: 12px; border: 1px solid var(--card-border); background: linear-gradient(135deg, #000, #fff); color: white; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
<i class="fas fa-eye"></i> High Contrast
</button>
</div>
</div>
</div>

<!-- JavaScript Files -->
<script src="env.js"></script>
<script src="js/rate-limiter.js"></script>
<script src="js/content-library-themes.js"></script>
<script src="js/content-library-features.js"></script>

<!-- Simple Supabase REST client -->
<script>
class ContentSupabaseClient {
constructor(url, key) {
this.url = url;
this.key = key;
}
fixMediaUrl(url) {
if (!url) return '';
if (url.startsWith('http')) return url;
return `https://ydnxqnbjoshvxteevemc.supabase.co/storage/v1/object/public/${url.replace(/^\/+/, '')}`;
}
}
const contentSupabase = new ContentSupabaseClient(
'https://ydnxqnbjoshvxteevemc.supabase.co',
'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZWV2ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U'
);
console.log('âœ… Content Supabase client initialized');
</script>

<!-- Creator Channel JavaScript -->
<script>
const SUPABASE_URL = 'https://ydnxqnbjoshvxteevemc.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZWV2ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U';
const supabaseAuth = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
console.log('âœ… Supabase Auth client initialized');

// Global state
window.currentUser = null;
window.notifications = [];
window.creatorId = null;
window.creatorProfile = null;
window.isConnected = false;
window.connectorCount = 0;

document.addEventListener('DOMContentLoaded', async () => {
console.log('ðŸ‘¤ Creator Channel Initializing...');
const loadingScreen = document.getElementById('loading');
const loadingText = document.getElementById('loading-text');
const app = document.getElementById('app');

// UTILITY FUNCTIONS
function showToast(message, type = 'info') {
const container = document.getElementById('toast-container');
if (!container) return;
const toast = document.createElement('div');
toast.className = `toast ${type}`;
const icons = {error:'fa-exclamation-triangle',success:'fa-check-circle',warning:'fa-exclamation-circle',info:'fa-info-circle'};
toast.innerHTML = `<i class="fas ${icons[type] || 'fa-info-circle'}"></i><span>${escapeHtml(message)}</span>`;
container.appendChild(toast);
setTimeout(() => { toast.style.opacity='0'; toast.style.transform='translateX(100%)'; setTimeout(() => toast.remove(), 300); }, 3000);
}

function formatNumber(num) {
if (num >= 1000000) return (num/1000000).toFixed(1)+'M';
if (num >= 1000) return (num/1000).toFixed(1)+'K';
return num.toString();
}

function truncateText(text, maxLength) {
if (!text) return '';
if (text.length <= maxLength) return text;
return text.substring(0, maxLength) + '...';
}

function escapeHtml(text) {
if (!text) return '';
const div = document.createElement('div');
div.textContent = text;
return div.innerHTML;
}

function formatDate(dateString) {
if (!dateString) return '';
try {
const date = new Date(dateString);
const now = new Date();
const diffDays = Math.floor(Math.abs(now - date) / (1000*60*60*24));
if (diffDays === 0) return 'Today';
if (diffDays === 1) return 'Yesterday';
if (diffDays < 7) return `${diffDays} days ago`;
if (diffDays < 30) return `${Math.floor(diffDays/7)} week${Math.floor(diffDays/7)>1?'s':''} ago`;
return date.toLocaleDateString('en-US', { month:'short', day:'numeric' });
} catch (error) { return ''; }
}

function getInitials(name) {
if (!name || name.trim() === '') return '?';
const names = name.trim().split(' ');
if (names.length >= 2) return (names[0][0] + names[names.length-1][0]).toUpperCase();
return name[0].toUpperCase();
}

function fixMediaUrl(url) {
if (!url) return '';
if (url.startsWith('http')) return url;
return `https://ydnxqnbjoshvxteevemc.supabase.co/storage/v1/object/public/${url.replace(/^\/+/, '')}`;
}

// AUTHENTICATION
async function checkAuth() {
try {
const { data: { session }, error } = await supabaseAuth.auth.getSession();
if (error) throw error;
window.currentUser = session?.user || null;
if (window.currentUser) {
console.log('âœ… User authenticated:', window.currentUser.email);
await loadUserProfile();
} else {
console.log('âš ï¸ User not authenticated');
updateProfileUI(null);
}
return window.currentUser;
} catch (error) {
console.error('Auth check error:', error);
return null;
}
}

async function loadUserProfile() {
try {
if (!window.currentUser) return;
const { data: profile, error } = await supabaseAuth
.from('user_profiles')
.select('*')
.eq('id', window.currentUser.id)
.maybeSingle();
if (error) { console.warn('Profile fetch error:', error); updateProfileUI(null); return; }
updateProfileUI(profile);
await loadNotifications();
} catch (error) {
console.error('Error loading profile:', error);
updateProfileUI(null);
}
}

function updateProfileUI(profile) {
const el = document.getElementById('userProfilePlaceholder');
if (!el) return;
while (el.firstChild) el.removeChild(el.firstChild);
if (profile) {
const displayName = profile.full_name || profile.username || window.currentUser?.email || 'User';
const initial = getInitials(displayName);
const avatarUrl = profile.avatar_url;
if (avatarUrl) {
const img = document.createElement('img');
img.className = 'profile-img';
img.alt = displayName;
img.style.cssText = 'width:100%;height:100%;border-radius:50%;object-fit:cover;';
try {
img.src = avatarUrl.startsWith('http') ? avatarUrl : 
         (avatarUrl.startsWith('avatars/') ? 
          `${SUPABASE_URL}/storage/v1/object/public/${avatarUrl}` : 
          `${SUPABASE_URL}/storage/v1/object/public/avatars/${avatarUrl}`);
img.onerror = () => {
const fallback = document.createElement('div');
fallback.className = 'profile-placeholder';
fallback.style.cssText = 'width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#1D4ED8,#F59E0B);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:16px';
fallback.textContent = initial;
el.innerHTML = ''; el.appendChild(fallback);
};
el.appendChild(img);
} catch (e) {
console.error('Invalid avatar URL:', e);
const fallback = document.createElement('div');
fallback.className = 'profile-placeholder';
fallback.style.cssText = 'width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#1D4ED8,#F59E0B);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:16px';
fallback.textContent = initial;
el.appendChild(fallback);
}
} else {
const fallback = document.createElement('div');
fallback.className = 'profile-placeholder';
fallback.style.cssText = 'width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#1D4ED8,#F59E0B);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:16px';
fallback.textContent = initial;
el.appendChild(fallback);
}
} else {
const icon = document.createElement('i');
icon.className = 'fas fa-user';
el.appendChild(icon);
}
}

// NOTIFICATIONS
async function loadNotifications() {
try {
if (!window.currentUser) { updateNotificationBadge(0); return; }
const { data, error } = await supabaseAuth
.from('notifications')
.select('*')
.eq('user_id', window.currentUser.id)
.order('created_at', { ascending: false })
.limit(20);
if (error) throw error;
window.notifications = data || [];
const unreadCount = window.notifications.filter(n => !n.is_read).length;
updateNotificationBadge(unreadCount);
} catch (error) {
console.error('Error loading notifications:', error);
updateNotificationBadge(0);
}
}

function updateNotificationBadge(count) {
const mainBadge = document.getElementById('notification-count');
const navBadge = document.getElementById('nav-notification-count');
[mainBadge, navBadge].forEach(badge => {
if (badge) {
badge.textContent = count > 99 ? '99+' : count;
badge.style.display = count > 0 ? 'flex' : 'none';
}
});
}

function renderNotifications() {
const list = document.getElementById('notifications-list');
if (!list) return;
if (!window.currentUser) {
list.innerHTML = `<div style="text-align:center;padding:40px;color:var(--slate-grey);"><i class="fas fa-bell-slash" style="font-size:48px;margin-bottom:15px;opacity:0.5;"></i><p>Sign in to see notifications</p></div>`;
return;
}
if (!window.notifications || window.notifications.length === 0) {
list.innerHTML = `<div style="text-align:center;padding:40px;color:var(--slate-grey);"><i class="fas fa-bell" style="font-size:48px;margin-bottom:15px;opacity:0.3;"></i><p>No notifications yet</p></div>`;
return;
}
list.innerHTML = window.notifications.map(n => `
<div style="padding:15px;border-bottom:1px solid var(--card-border);${n.is_read?'opacity:0.7;':'background:rgba(245,158,11,0.1);'}">
<div style="display:flex;gap:12px;">
<div style="width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--bantu-blue),var(--warm-gold));display:flex;align-items:center;justify-content:center;flex-shrink:0;">
<i class="${getNotificationIcon(n.type)}" style="font-size:18px;"></i>
</div>
<div style="flex:1;">
<div style="font-weight:600;margin-bottom:5px;color:var(--soft-white);">${escapeHtml(n.title)}</div>
<div style="font-size:14px;color:var(--slate-grey);margin-bottom:8px;">${escapeHtml(n.message)}</div>
<div style="font-size:12px;color:var(--warm-gold);">${formatNotificationTime(n.created_at)}</div>
</div>
${!n.is_read ? '<div style="width:10px;height:10px;border-radius:50%;background:var(--warm-gold);margin-top:5px;"></div>' : ''}
</div>
</div>
`).join('');
}

function getNotificationIcon(type) {
switch(type) { case 'like': return 'fas fa-heart'; case 'comment': return 'fas fa-comment'; case 'follow': return 'fas fa-user-plus'; default: return 'fas fa-bell'; }
}

function formatNotificationTime(timestamp) {
if (!timestamp) return 'Just now';
const diffMs = Date.now() - new Date(timestamp).getTime();
const diffMins = Math.floor(diffMs/60000);
const diffHours = Math.floor(diffMs/3600000);
const diffDays = Math.floor(diffMs/86400000);
if (diffMins < 1) return 'Just now';
if (diffMins < 60) return `${diffMins}m ago`;
if (diffHours < 24) return `${diffHours}h ago`;
if (diffDays < 7) return `${diffDays}d ago`;
return new Date(timestamp).toLocaleDateString();
}

// SEARCH FUNCTIONALITY
async function searchContent(query, category = '', sortBy = 'newest') {
try {
let qb = supabaseAuth.from('Content').select('*, user_profiles!user_id(*)').ilike('title', `%${query}%`).eq('status','published');
if (category) qb = qb.eq('genre', category);
if (sortBy === 'newest') qb = qb.order('created_at', {ascending:false});
const {data, error} = await qb.limit(50);
if (error) throw error;
const enriched = await Promise.all((data||[]).map(async item => {
const {count:views} = await supabaseAuth.from('content_views').select('*',{count:'exact',head:true}).eq('content_id',item.id);
const {count:likes} = await supabaseAuth.from('content_likes').select('*',{count:'exact',head:true}).eq('content_id',item.id);
return {...item, real_views:views||0, real_likes:likes||0};
}));
if (sortBy === 'popular') enriched.sort((a,b) => (b.real_views||0)-(a.real_views||0));
else if (sortBy === 'trending') enriched.sort((a,b) => ((b.real_views||0)+((b.real_likes||0)*2)) - ((a.real_views||0)+((a.real_likes||0)*2)));
return enriched;
} catch (error) { console.error('Search error:', error); return []; }
}

function renderSearchResults(results) {
const grid = document.getElementById('search-results-grid');
if (!grid) return;
if (!results || results.length === 0) {
grid.innerHTML = '<div style="text-align:center;padding:40px;color:var(--slate-grey);">No results found. Try different keywords.</div>';
return;
}
grid.innerHTML = results.map(item => {
const creator = item.user_profiles?.full_name || item.user_profiles?.username || item.creator || 'Creator';
const thumbnailUrl = item.thumbnail_url ? fixMediaUrl(item.thumbnail_url) : 'https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=400&h=225&fit=crop';
const displayName = item.user_profiles?.full_name || item.user_profiles?.username || 'User';
const initials = getInitials(displayName);
let avatarHtml = '';
if (item.user_profiles?.avatar_url) {
const avatarUrl = fixMediaUrl(item.user_profiles.avatar_url);
avatarHtml = `<img src="${avatarUrl}" alt="${escapeHtml(displayName)}" onerror="this.parentElement.innerHTML='<div class=\\'creator-initials-small\\'>${initials}</div>'" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">`;
} else {
avatarHtml = `<div class="creator-initials-small" style="width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,var(--bantu-blue),var(--warm-gold));display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:12px;">${initials}</div>`;
}
return `
<div class="content-card" data-content-id="${item.id}" style="background:var(--card-bg);border:1px solid var(--card-border);border-radius:20px;overflow:hidden;transition:all 0.3s ease;text-decoration:none;color:inherit;backdrop-filter:blur(10px);">
<div class="card-thumbnail" style="position:relative;height:140px;overflow:hidden;">
<img src="${thumbnailUrl}" alt="${escapeHtml(item.title)}" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1511379938547-c1f69419868d?w=400&h=225&fit=crop'" style="width:100%;height:100%;object-fit:cover;transition:transform 0.3s ease;">
<div style="position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.5) 100%);"></div>
<div style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s ease;">
<div style="width:50px;height:50px;background:rgba(245,158,11,0.9);border-radius:50%;display:flex;align-items:center;justify-content:center;color:var(--deep-black);font-size:1.5rem;transform:scale(0.8);transition:all 0.3s ease;">
<i class="fas fa-play"></i>
</div>
</div>
</div>
<div class="card-content" style="padding:15px;">
<h3 class="card-title" style="font-size:16px;font-weight:600;margin-bottom:10px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:40px;color:var(--soft-white);">${truncateText(escapeHtml(item.title),45)}</h3>
<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
<div style="width:30px;height:30px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--bantu-blue),var(--warm-gold));color:white;font-weight:bold;font-size:12px;flex-shrink:0;">
${avatarHtml}
</div>
<div style="font-size:14px;color:var(--slate-grey);">@${escapeHtml(item.user_profiles?.username || creator)}</div>
</div>
<div style="display:flex;gap:15px;font-size:12px;color:var(--slate-grey);">
<div style="display:flex;align-items:center;gap:4px;"><i class="fas fa-eye" style="color:var(--bantu-blue);"></i> ${formatNumber(item.real_views || item.views_count || 0)}</div>
<div style="display:flex;align-items:center;gap:4px;"><i class="fas fa-heart" style="color:#ef4444;"></i> ${formatNumber(item.real_likes || 0)}</div>
</div>
</div>
</div>
`;
}).join('');
grid.querySelectorAll('.content-card').forEach(card => {
card.addEventListener('click', e => {
if (e.target.closest('.creator-btn')) return;
const id = card.dataset.contentId;
if (id) window.location.href = `content-detail.html?id=${id}`;
});
});
const style = document.createElement('style');
style.textContent = `.content-card:hover{transform:translateY(-8px);box-shadow:0 20px 40px rgba(0,0,0,0.4);border-color:rgba(245,158,11,0.3);}.content-card:hover .card-thumbnail img{transform:scale(1.05);}.content-card:hover .card-thumbnail>div:nth-child(2){opacity:1;}.content-card:hover .card-thumbnail>div:nth-child(2)>div{transform:scale(1);}`;
document.head.appendChild(style);
}

// CREATOR DATA FUNCTIONS
function getUrlParam(name) {
const urlParams = new URLSearchParams(window.location.search);
return urlParams.get(name);
}

async function loadCreatorData() {
try {
window.creatorId = getUrlParam('id');
if (!window.creatorId) { showToast('Creator ID not found', 'error'); window.location.href='https://bantustreamconnect.com/content-library'; return; }

loadingText.textContent = 'Loading creator profile...';
const { data: profile, error: profileError } = await supabaseAuth
.from('user_profiles')
.select('*')
.eq('id', window.creatorId)
.maybeSingle();
if (profileError || !profile) { showToast('Creator not found', 'error'); window.location.href='https://bantustreamconnect.com/content-library'; return; }
window.creatorProfile = profile;

loadingText.textContent = 'Loading creator content...';
const { data: content, error: contentError } = await supabaseAuth
.from('Content')
.select('*, user_profiles!user_id(*)')
.eq('user_id', window.creatorId)
.eq('status', 'published')
.order('created_at', { ascending: false })
.limit(50);
if (contentError) throw contentError;

// FIXED: Changed from 'user_connections' to 'connectors'
const { count: connectorCount, error: countError } = await supabaseAuth
.from('connectors')
.select('*', { count: 'exact', head: true })
.eq('connected_id', window.creatorId)
.eq('connection_type', 'creator');
if (countError) throw countError;
window.connectorCount = connectorCount || 0;

if (window.currentUser) {
const { data: connections } = await supabaseAuth
.from('connectors')
.select('*')
.eq('connector_id', window.currentUser.id)
.eq('connected_id', window.creatorId)
.eq('connection_type', 'creator')
.limit(1);
window.isConnected = connections && connections.length > 0;
} else {
window.isConnected = false;
}

console.log('âœ… Creator data loaded:', { profile, contentCount: content.length, connectorCount, isConnected: window.isConnected });
updateCreatorUI();
updateContentUI(content);
} catch (error) {
console.error('âŒ Error loading creator channel:', error);
showToast('Failed to load creator channel', 'error');
}
}

function updateCreatorUI() {
if (!window.creatorProfile) return;

// Set creator info
document.getElementById('creator-name').textContent = window.creatorProfile.full_name || window.creatorProfile.username || 'Creator';
document.getElementById('creator-username').textContent = `@${window.creatorProfile.username || 'creator'}`;
document.getElementById('creator-bio').textContent = window.creatorProfile.bio || 'Passionate content creator sharing authentic African stories and experiences.';
document.getElementById('full-bio').textContent = window.creatorProfile.bio || 'Passionate content creator sharing authentic African stories and experiences.';

// Banner title
document.getElementById('banner-title').textContent = `${window.creatorProfile.full_name || window.creatorProfile.username}'s Channel`;

// Location (if available)
if (window.creatorProfile.location) {
document.getElementById('location').textContent = window.creatorProfile.location;
} else {
document.querySelector('.about-item:nth-child(2)').style.display = 'none';
}

// Joined date
if (window.creatorProfile.created_at) {
const joinDate = new Date(window.creatorProfile.created_at);
document.getElementById('joined-date').textContent = `Joined ${joinDate.toLocaleString('default', { month: 'long', year: 'numeric' })}`;
}

// Website link
if (window.creatorProfile.website_url) {
const websiteLink = document.getElementById('website-link');
websiteLink.href = window.creatorProfile.website_url;
websiteLink.textContent = window.creatorProfile.website_url.replace(/^https?:\/\//, '');
} else {
document.querySelector('.about-item:nth-child(3)').style.display = 'none';
}

// Interests/tags
if (window.creatorProfile.interests) {
document.getElementById('interests').textContent = window.creatorProfile.interests;
} else {
document.querySelector('.about-item:nth-child(4)').style.display = 'none';
}

// Avatar with perfect circle
const avatarContainer = document.getElementById('creator-avatar-container');
const avatarUrl = window.creatorProfile.avatar_url ? fixMediaUrl(window.creatorProfile.avatar_url) : null;
const displayName = window.creatorProfile.full_name || window.creatorProfile.username || 'Creator';
const initials = getInitials(displayName);
if (avatarUrl) {
avatarContainer.innerHTML = `<img src="${avatarUrl}" alt="${displayName}" onerror="this.parentElement.innerHTML='<div class=\\'creator-initials\\'>${initials}</div>'" style="width:100%;height:100%;object-fit:cover;display:block;border-radius:50%;">`;
} else {
avatarContainer.innerHTML = `<div class="creator-initials">${initials}</div>`;
}

// Founder badge
if (window.creatorProfile.is_founder) {
document.getElementById('founder-badge').style.display = 'block';
}

// Stats
document.getElementById('videos-count').textContent = document.getElementById('uploads-count').textContent = '0';
document.getElementById('connectors-count').textContent = formatNumber(window.connectorCount);

// Connect button
updateConnectButton();

// Check if own channel
if (window.currentUser && window.currentUser.id === window.creatorId) {
const connectBtn = document.getElementById('connect-btn');
connectBtn.disabled = true;
connectBtn.innerHTML = '<i class="fas fa-user"></i> This is your channel';
connectBtn.classList.remove('connect-btn', 'connected-btn');
connectBtn.classList.add('share-btn');
}
}

function updateContentUI(content) {
const grid = document.getElementById('content-grid');
const noContent = document.getElementById('no-content');
const countEl = document.getElementById('content-count');

document.getElementById('videos-count').textContent = content.length;
document.getElementById('uploads-count').textContent = content.length;
countEl.textContent = `${content.length} item${content.length !== 1 ? 's' : ''}`;

if (content.length === 0) {
grid.style.display = 'none';
noContent.style.display = 'block';
return;
}

grid.style.display = 'grid';
noContent.style.display = 'none';
grid.innerHTML = '';

content.forEach(item => {
const thumbnailUrl = item.thumbnail_url ? fixMediaUrl(item.thumbnail_url) : 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=225&fit=crop';
const displayName = item.user_profiles?.full_name || item.user_profiles?.username || 'User';
const initials = getInitials(displayName);
let avatarHtml = '';
if (item.user_profiles?.avatar_url) {
const avatarUrl = fixMediaUrl(item.user_profiles.avatar_url);
avatarHtml = `<img src="${avatarUrl}" alt="${escapeHtml(displayName)}" onerror="this.parentElement.innerHTML='<div class=\\'creator-initials-small\\'>${initials}</div>'" style="width:100%;height:100%;object-fit:cover;">`;
} else {
avatarHtml = `<div class="creator-initials-small" style="width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,var(--bantu-blue),var(--warm-gold));display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:12px;">${initials}</div>`;
}

const card = document.createElement('a');
card.className = 'content-card';
card.href = `content-detail.html?id=${item.id}`;
card.innerHTML = `
<div class="card-thumbnail">
<img src="${thumbnailUrl}" alt="${escapeHtml(item.title)}" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=225&fit=crop'">
<div class="thumbnail-overlay"></div>
${(new Date() - new Date(item.created_at)) < 7*24*60*60*1000 ? '<div class="badge-new card-badge"><i class="fas fa-gem"></i> NEW</div>' : ''}
<div class="play-overlay">
<div class="play-icon"><i class="fas fa-play"></i></div>
</div>
</div>
<div class="card-content">
<h3 class="card-title" title="${escapeHtml(item.title)}">${truncateText(escapeHtml(item.title), 50)}</h3>
<div class="creator-info">
<div class="creator-avatar-small">${avatarHtml}</div>
<div class="creator-name-small">@${escapeHtml(item.user_profiles?.username || (item.user_profiles?.full_name || item.creator || 'Creator'))}</div>
</div>
<div class="card-meta">
<span><i class="fas fa-eye"></i> ${formatNumber(item.views_count || 0)}</span>
<span>${item.media_type || 'video'}</span>
</div>
</div>
`;
grid.appendChild(card);
});
}

function updateConnectButton() {
const btn = document.getElementById('connect-btn');
if (!window.currentUser) {
btn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Log in to Connect';
btn.classList.remove('connected-btn');
btn.classList.add('connect-btn');
btn.onclick = handleLoginRequired;
return;
}
if (window.currentUser.id === window.creatorId) {
btn.disabled = true;
btn.innerHTML = '<i class="fas fa-user"></i> This is your channel';
return;
}
if (window.isConnected) {
btn.innerHTML = '<i class="fas fa-link"></i> Connected';
btn.classList.remove('connect-btn');
btn.classList.add('connected-btn');
btn.onclick = handleDisconnect;
} else {
btn.innerHTML = '<i class="fas fa-link"></i> Connect';
btn.classList.remove('connected-btn');
btn.classList.add('connect-btn');
btn.onclick = handleConnect;
}
}

function handleLoginRequired() {
showToast('Please log in to connect with creators', 'info');
window.location.href = `login.html?redirect=creator-channel.html?id=${window.creatorId}`;
}

// FIXED: Changed from 'user_connections' to 'connectors'
async function handleConnect() {
if (!window.currentUser) { handleLoginRequired(); return; }
if (window.currentUser.id === window.creatorId) { showToast('You cannot connect to your own channel', 'info'); return; }
try {
const { error } = await supabaseAuth.from('connectors').insert({
connector_id: window.currentUser.id,
connected_id: window.creatorId,
connection_type: 'creator',
created_at: new Date().toISOString()
});
if (error) throw error;
window.isConnected = true;
window.connectorCount++;
updateConnectButton();
document.getElementById('connectors-count').textContent = formatNumber(window.connectorCount);
document.querySelector('#connectors-stat-card .stat-number').textContent = formatNumber(window.connectorCount);
showToast(`Connected with ${window.creatorProfile.full_name || window.creatorProfile.username}`, 'success');
} catch (error) {
console.error('Error connecting:', error);
showToast('Failed to connect', 'error');
}
}

// FIXED: Changed from 'user_connections' to 'connectors'
async function handleDisconnect() {
try {
const { error } = await supabaseAuth.from('connectors').delete()
.eq('connector_id', window.currentUser.id)
.eq('connected_id', window.creatorId)
.eq('connection_type', 'creator');
if (error) throw error;
window.isConnected = false;
window.connectorCount = Math.max(0, window.connectorCount - 1);
updateConnectButton();
document.getElementById('connectors-count').textContent = formatNumber(window.connectorCount);
document.querySelector('#connectors-stat-card .stat-number').textContent = formatNumber(window.connectorCount);
showToast(`Disconnected from ${window.creatorProfile.full_name || window.creatorProfile.username}`, 'info');
} catch (error) {
console.error('Error disconnecting:', error);
showToast('Failed to disconnect', 'error');
}
}

function handleShare() {
if (!window.creatorProfile) return;
const name = window.creatorProfile.full_name || window.creatorProfile.username || 'this creator';
const text = `Check out ${name}'s channel on Bantu Stream Connect! Connect with amazing creators and discover exclusive content. ðŸš€`;
const url = window.location.href;
if (navigator.share) {
navigator.share({ title: `${name}'s Channel`, text, url });
} else {
navigator.clipboard.writeText(`${text}\n${url}`)
.then(() => showToast('Link copied to clipboard!', 'success'))
.catch(() => showToast('Failed to copy link', 'error'));
}
}

// FIXED: Changed from 'user_connections' to 'connectors'
async function showConnectorsModal() {
try {
const { data: connectors, error } = await supabaseAuth
.from('connectors')
.select(`connector_id, user_profiles!inner(id, full_name, username, avatar_url)`)
.eq('connected_id', window.creatorId)
.eq('connection_type', 'creator');
if (error) throw error;
const title = document.getElementById('modal-title');
const list = document.getElementById('connectors-list');
const profiles = connectors.map(c => c.user_profiles);
title.textContent = `Connectors (${profiles.length})`;
if (profiles.length === 0) {
list.innerHTML = '<div style="text-align:center;padding:40px;color:var(--slate-grey);">No connectors yet</div>';
} else {
list.innerHTML = profiles.map(p => {
const avatarUrl = p.avatar_url ? fixMediaUrl(p.avatar_url) : 'https://images.unsplash.com/photo-1633332755192-727a05c4013d?w=400&h=400&fit=crop';
const displayName = p.full_name || p.username || 'User';
const initials = getInitials(displayName);
let avatarHtml = '';
if (avatarUrl) {
avatarHtml = `<img src="${avatarUrl}" alt="${escapeHtml(displayName)}" onerror="this.parentElement.innerHTML='<div style=\\'width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#1D4ED8,#F59E0B);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:16px\\'>${initials}</div>'" style="width:100%;height:100%;object-fit:cover;">`;
} else {
avatarHtml = `<div style="width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,#1D4ED8,#F59E0B);display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:16px">${initials}</div>`;
}
return `
<div class="connector-item">
<div class="connector-avatar">${avatarHtml}</div>
<div class="connector-info">
<div class="connector-name">${escapeHtml(p.full_name || p.username)}</div>
<div class="connector-username">@${escapeHtml(p.username || 'user')}</div>
</div>
</div>
`;
}).join('');
}
document.getElementById('connectors-modal').classList.add('active');
} catch (error) {
console.error('Error loading connectors:', error);
showToast('Failed to load connectors', 'error');
}
}

// EVENT LISTENERS
function setupEventListeners() {
// Profile button
document.getElementById('profile-btn')?.addEventListener('click', async () => {
const { data: { session } } = await supabaseAuth.auth.getSession();
session ? window.location.href='profile.html' : window.location.href=`login.html?redirect=${encodeURIComponent(window.location.href)}`;
});

// Search button
document.getElementById('search-btn')?.addEventListener('click', () => {
document.getElementById('search-modal').classList.add('active');
setTimeout(() => document.getElementById('search-input')?.focus(), 300);
});

// Close search modal
document.getElementById('close-search-btn')?.addEventListener('click', () => {
document.getElementById('search-modal').classList.remove('active');
document.getElementById('search-input').value = '';
document.getElementById('search-results-grid').innerHTML = '';
});

// Search modal background click
document.getElementById('search-modal').addEventListener('click', e => {
if (e.target === document.getElementById('search-modal')) {
document.getElementById('search-modal').classList.remove('active');
document.getElementById('search-input').value = '';
document.getElementById('search-results-grid').innerHTML = '';
}
});

// Live search
const searchInput = document.getElementById('search-input');
if (searchInput) {
let timeout;
searchInput.addEventListener('input', e => {
clearTimeout(timeout);
timeout = setTimeout(async () => {
const query = e.target.value.trim();
if (query.length < 2) {
document.getElementById('search-results-grid').innerHTML = '<div style="text-align:center;padding:40px;color:var(--slate-grey);">Start typing to search...</div>';
return;
}
document.getElementById('search-results-grid').innerHTML = `
<div style="text-align:center;padding:40px;">
<div style="width:40px;height:40px;border:3px solid rgba(255,255,255,0.1);border-radius:50%;border-top-color:var(--warm-gold);animation:spin 1s linear infinite;margin:0 auto 15px;"></div>
<div style="color:var(--slate-grey);">Searching...</div>
</div>`;
const results = await searchContent(query, document.getElementById('category-filter')?.value, document.getElementById('sort-filter')?.value);
renderSearchResults(results);
}, 300);
});
}

// Filter changes trigger search
document.getElementById('category-filter')?.addEventListener('change', () => {
if (searchInput && searchInput.value.trim().length >= 2) searchInput.dispatchEvent(new Event('input'));
});
document.getElementById('sort-filter')?.addEventListener('change', () => {
if (searchInput && searchInput.value.trim().length >= 2) searchInput.dispatchEvent(new Event('input'));
});

// Share button
document.getElementById('share-btn')?.addEventListener('click', handleShare);

// Connectors stat card
document.getElementById('connectors-stat-card')?.addEventListener('click', showConnectorsModal);

// Close connectors modal
document.getElementById('close-modal-btn')?.addEventListener('click', () => {
document.getElementById('connectors-modal').classList.remove('active');
});
document.getElementById('connectors-modal').addEventListener('click', e => {
if (e.target === document.getElementById('connectors-modal')) {
document.getElementById('connectors-modal').classList.remove('active');
}
});

// Notifications
document.getElementById('notifications-btn')?.addEventListener('click', () => {
document.getElementById('notifications-panel').classList.add('active');
renderNotifications();
});
document.getElementById('close-notifications')?.addEventListener('click', () => {
document.getElementById('notifications-panel').classList.remove('active');
});
document.getElementById('notifications-panel').addEventListener('click', e => {
if (e.target === document.getElementById('notifications-panel')) {
document.getElementById('notifications-panel').classList.remove('active');
}
});
document.getElementById('mark-all-read')?.addEventListener('click', async () => {
if (!window.currentUser) return;
try {
const { error } = await supabaseAuth.from('notifications').update({is_read:true}).eq('user_id',window.currentUser.id).eq('is_read',false);
if (error) throw error;
window.notifications = window.notifications.map(n => ({...n, is_read:true}));
renderNotifications();
updateNotificationBadge(0);
showToast('All notifications marked as read', 'success');
} catch (error) {
console.error('Error marking all as read:', error);
showToast('Failed to mark notifications as read', 'error');
}
});

// Theme toggle
const themeToggle = document.getElementById('nav-theme-toggle');
const themeSelector = document.getElementById('theme-selector');
if (themeToggle && themeSelector) {
themeToggle.addEventListener('click', e => { e.stopPropagation(); themeSelector.style.display = themeSelector.style.display === 'flex' ? 'none' : 'flex'; });
document.addEventListener('click', e => {
if (themeSelector.style.display === 'flex' && !themeSelector.contains(e.target) && !themeToggle.contains(e.target)) {
themeSelector.style.display = 'none';
}
});
document.querySelectorAll('.theme-option').forEach(option => {
option.addEventListener('click', () => {
if (typeof window.applyTheme === 'function') window.applyTheme(option.dataset.theme);
themeSelector.style.display = 'none';
});
});
}

// Navigation buttons
document.getElementById('nav-home-btn')?.addEventListener('click', () => window.location.href='index.html');
document.getElementById('nav-create-btn')?.addEventListener('click', async () => {
const { data: { session } } = await supabaseAuth.auth.getSession();
session ? window.location.href='creator-upload.html' : (showToast('Please sign in to upload content', 'warning'), window.location.href='login.html?redirect=creator-upload.html');
});
document.getElementById('nav-dashboard-btn')?.addEventListener('click', async () => {
const { data: { session } } = await supabaseAuth.auth.getSession();
session ? window.location.href='creator-dashboard.html' : (showToast('Please sign in to access dashboard', 'warning'), window.location.href='login.html?redirect=creator-dashboard.html');
});
document.getElementById('nav-notifications-btn')?.addEventListener('click', () => {
document.getElementById('notifications-panel').classList.add('active');
renderNotifications();
});

// Back to top
const backToTopBtn = document.getElementById('backToTopBtn');
if (backToTopBtn) {
backToTopBtn.addEventListener('click', () => window.scrollTo({top:0,behavior:'smooth'}));
window.addEventListener('scroll', () => {
backToTopBtn.style.display = window.pageYOffset > 300 ? 'flex' : 'none';
});
}
}

// INITIALIZE
async function initializeCreatorChannel() {
try {
document.getElementById('loading').style.display = 'flex';
document.getElementById('app').style.display = 'none';

if (typeof window.initTheme === 'function') window.initTheme();
await checkAuth();
await loadCreatorData();
setupEventListeners();

setTimeout(() => {
document.getElementById('loading').style.display = 'none';
document.getElementById('app').style.display = 'block';
document.querySelectorAll('.content-card').forEach((card, i) => {
setTimeout(() => { card.style.opacity='1'; card.style.transform='translateY(0)'; }, 300 + (i * 50));
});
}, 500);
console.log('âœ… Creator channel initialized successfully');
} catch (error) {
console.error('âŒ Error initializing creator channel:', error);
showToast('Failed to initialize creator channel', 'error');
setTimeout(() => { document.getElementById('loading').style.display='none'; document.getElementById('app').style.display='block'; }, 1000);
}
}

await initializeCreatorChannel();

// Auth state change listener
supabaseAuth.auth.onAuthStateChange((event, session) => {
console.log('Auth state changed:', event);
if (event === 'SIGNED_IN') {
window.currentUser = session.user;
loadUserProfile();
loadNotifications();
showToast('Welcome back!', 'success');
if (window.creatorId) {
supabaseAuth.from('connectors').select('*').eq('connector_id',session.user.id).eq('connected_id',window.creatorId).eq('connection_type','creator').limit(1)
.then(({data}) => { window.isConnected = data && data.length > 0; updateConnectButton(); });
}
} else if (event === 'SIGNED_OUT') {
window.currentUser = null;
updateProfileUI(null);
updateNotificationBadge(0);
window.notifications = [];
renderNotifications();
showToast('You have been signed out', 'info');
window.isConnected = false;
updateConnectButton();
}
});
});
</script>
</body>
</html>
