<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Details - Bantu Stream Connect</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Color Theme (from Flutter app) */
        :root {
            --deep-black: #0A0E12;
            --deep-navy: #0F172A;
            --soft-white: #F8FAFC;
            --slate-grey: #94A3B8;
            --bantu-blue: #1D4ED8;
            --warm-gold: #F59E0B;
            --error-color: #EF4444;
            --success-color: #10B981;
            --glow-blue-1: #00A3FF;
            --glow-blue-2: #0066FF;
            --glow-purple: #8B5CF6;
            --glow-pink: #EC4899;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--deep-black);
            color: var(--soft-white);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--deep-black);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--warm-gold);
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
            background: linear-gradient(45deg, #0a1f3a, #2a4a7f, #0a1f3a);
            background-size: 400% 400%;
            animation: gradientPulse 15s ease infinite;
        }
        
        @keyframes gradientPulse {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Glassmorphism Effects */
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .glassmorphism-gold {
            background: rgba(245, 158, 11, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(245, 158, 11, 0.3);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(245, 158, 11, 0.2);
        }
        
        /* Navigation */
        .main-nav {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--soft-white);
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            letter-spacing: 1px;
        }
        
        .nav-brand i {
            color: var(--warm-gold);
        }
        
        .nav-center {
            display: flex;
            gap: 2rem;
        }
        
        .nav-link {
            color: var(--soft-white);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .nav-link.active {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warm-gold);
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .search-box {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
        }
        
        .search-box input {
            background: transparent;
            border: none;
            padding: 0.5rem 1rem;
            color: var(--soft-white);
            width: 200px;
        }
        
        .search-box input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .search-box button {
            background: transparent;
            border: none;
            color: var(--soft-white);
            padding: 0.5rem 1rem;
            cursor: pointer;
        }
        
        .user-avatar {
            color: var(--soft-white);
            font-size: 1.5rem;
            text-decoration: none;
        }
        
        /* Main Content */
        .content-container {
            position: relative;
            z-index: 2;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Hero Section */
        .hero-section {
            position: relative;
            margin: 2rem 0;
            border-radius: 20px;
            overflow: hidden;
            min-height: 400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            filter: blur(20px);
            opacity: 0.5;
            z-index: 1;
        }
        
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(0,0,0,0.8), rgba(15, 23, 42, 0.9));
            z-index: 2;
        }
        
        .hero-content {
            position: relative;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            padding: 3rem;
            color: var(--soft-white);
            z-index: 3;
        }
        
        @media (max-width: 1024px) {
            .hero-content {
                grid-template-columns: 1fr;
            }
        }
        
        .hero-info h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: var(--soft-white);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .hero-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--slate-grey);
            font-size: 0.9rem;
        }
        
        .meta-item i {
            color: var(--warm-gold);
        }
        
        .hero-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }
        
        /* Glass Buttons */
        .glass-btn {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: var(--soft-white);
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .glass-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            border-color: rgba(245, 158, 11, 0.3);
        }
        
        .play-btn {
            background: linear-gradient(135deg, var(--warm-gold), #f97316);
            color: var(--deep-black);
            border: none;
            font-weight: 700;
        }
        
        .play-btn:hover {
            background: linear-gradient(135deg, #f97316, var(--warm-gold));
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
        }
        
        .hero-poster {
            height: 300px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 2px solid rgba(245, 158, 11, 0.3);
        }
        
        .poster-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--deep-navy), #1a1a2e);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--warm-gold);
            font-size: 4rem;
        }
        
        /* Content Info Section */
        .info-section {
            padding: 2rem;
            margin: 2rem 0;
            color: var(--soft-white);
        }
        
        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--warm-gold);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .creator-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .creator-avatar {
            font-size: 3rem;
            color: var(--warm-gold);
        }
        
        .creator-details {
            flex: 1;
        }
        
        .creator-details h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--soft-white);
        }
        
        .creator-details p {
            color: var(--slate-grey);
            font-size: 0.9rem;
        }
        
        .subscribe-btn {
            padding: 0.75rem 2rem;
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .subscribe-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }
        
        .subscribe-btn.subscribed {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        
        .info-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem;
        }
        
        .stat-item i {
            color: var(--warm-gold);
            font-size: 1.2rem;
            width: 30px;
        }
        
        /* Description Section */
        .description-section {
            padding: 2rem;
            margin: 2rem 0;
            color: var(--soft-white);
        }
        
        .description-content {
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .show-more-btn {
            background: transparent;
            color: var(--warm-gold);
            border: 1px solid var(--warm-gold);
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            margin-top: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .show-more-btn:hover {
            background: rgba(245, 158, 11, 0.1);
        }
        
        /* Comments Section */
        .comments-section {
            padding: 2rem;
            margin: 2rem 0;
            color: var(--soft-white);
        }
        
        .comments-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .refresh-btn {
            padding: 0.5rem 1.5rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: var(--soft-white);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .refresh-btn.refreshing {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .add-comment {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
        }
        
        .comment-avatar {
            font-size: 2rem;
            color: var(--warm-gold);
        }
        
        .comment-input-container {
            flex: 1;
            display: flex;
            gap: 1rem;
        }
        
        .comment-input-container textarea {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 1rem;
            color: var(--soft-white);
            resize: vertical;
            min-height: 60px;
            font-family: 'Inter', sans-serif;
        }
        
        .comment-input-container textarea:focus {
            outline: none;
            border-color: var(--warm-gold);
        }
        
        .send-comment-btn {
            background: linear-gradient(135deg, var(--warm-gold), #f97316);
            color: var(--deep-black);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease;
        }
        
        .send-comment-btn:hover {
            transform: scale(1.1);
        }
        
        .send-comment-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .comments-list {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        /* Scrollbar Styling */
        .comments-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .comments-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .comments-list::-webkit-scrollbar-thumb {
            background: var(--warm-gold);
            border-radius: 3px;
        }
        
        .no-comments {
            text-align: center;
            padding: 3rem;
            color: var(--slate-grey);
        }
        
        .no-comments i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.3);
        }
        
        .comment-item {
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .comment-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .comment-avatar-sm {
            font-size: 1.5rem;
            color: var(--warm-gold);
        }
        
        .comment-user {
            flex: 1;
        }
        
        .comment-user strong {
            color: var(--soft-white);
            font-size: 1rem;
        }
        
        .comment-time {
            color: var(--slate-grey);
            font-size: 0.8rem;
        }
        
        .comment-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .comment-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--soft-white);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .comment-action-btn:hover {
            transform: scale(1.1);
        }
        
        .edit-btn {
            color: #3B82F6;
        }
        
        .delete-btn {
            color: #EF4444;
        }
        
        .like-btn {
            color: #EF4444;
        }
        
        .like-btn.liked {
            color: #EF4444;
        }
        
        .comment-content {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            margin-bottom: 1rem;
            padding: 0 0.5rem;
        }
        
        .comment-footer {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0 0.5rem;
        }
        
        .like-count {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--slate-grey);
            font-size: 0.9rem;
        }
        
        /* Related Content Section */
        .related-section {
            padding: 2rem;
            margin: 2rem 0;
            color: var(--soft-white);
        }
        
        .related-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .related-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        
        .related-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-decoration: none;
            color: inherit;
        }
        
        .related-card:hover {
            transform: translateY(-5px);
            border-color: var(--warm-gold);
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.2);
        }
        
        .related-thumbnail {
            height: 150px;
            background: linear-gradient(45deg, var(--deep-navy), #1a1a2e);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--warm-gold);
            font-size: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .related-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .related-info {
            padding: 1rem;
        }
        
        .related-info h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            color: var(--soft-white);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .related-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--slate-grey);
            font-size: 0.9rem;
        }
        
        .related-meta i {
            color: var(--warm-gold);
        }
        
        .related-placeholder {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            color: var(--slate-grey);
        }
        
        .related-placeholder i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.3);
        }
        
        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }
        
        .modal-container {
            background: var(--deep-navy);
            padding: 2rem;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-header h3 {
            color: var(--warm-gold);
            margin: 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
        }
        
        .modal-close {
            background: transparent;
            border: none;
            color: var(--soft-white);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .modal-body {
            margin-bottom: 2rem;
        }
        
        .modal-body textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 1rem;
            color: var(--soft-white);
            font-family: 'Inter', sans-serif;
            resize: vertical;
            min-height: 100px;
        }
        
        .modal-body textarea:focus {
            outline: none;
            border-color: var(--warm-gold);
        }
        
        .modal-body p {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
        }
        
        .download-info {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .download-info i {
            color: var(--warm-gold);
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }
        
        .modal-btn {
            padding: 0.75rem 2rem;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
        }
        
        .cancel-btn {
            background: rgba(255, 255, 255, 0.1);
            color: var(--soft-white);
        }
        
        .cancel-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .save-btn {
            background: linear-gradient(135deg, var(--warm-gold), #f97316);
            color: var(--deep-black);
        }
        
        .delete-btn {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
        }
        
        .download-confirm-btn {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 3000;
        }
        
        .toast {
            background: var(--deep-navy);
            color: var(--soft-white);
            padding: 16px 24px;
            border-radius: 12px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
            border-left: 4px solid var(--warm-gold);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            max-width: 400px;
        }
        
        .toast.success {
            border-left-color: var(--success-color);
        }
        
        .toast.error {
            border-left-color: var(--error-color);
        }
        
        .toast.info {
            border-left-color: var(--bantu-blue);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .main-nav {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .nav-center {
                gap: 0.5rem;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .nav-right {
                width: 100%;
                justify-content: center;
            }
            
            .hero-content {
                padding: 2rem 1rem;
            }
            
            .hero-info h1 {
                font-size: 2rem;
            }
            
            .hero-actions {
                justify-content: center;
            }
            
            .comments-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
            
            .info-stats {
                grid-template-columns: 1fr;
            }
            
            .creator-info {
                flex-direction: column;
                text-align: center;
            }
            
            .subscribe-btn {
                margin: 0;
            }
        }
        
        @media (max-width: 480px) {
            .hero-meta {
                flex-direction: column;
                gap: 1rem;
            }
            
            .hero-actions {
                flex-direction: column;
            }
            
            .modal-container {
                width: 95%;
                padding: 1.5rem;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .modal-btn {
                width: 100%;
            }
        }
        
        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--warm-gold), #f97316);
            color: var(--deep-black);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            border: none;
            font-size: 1.5rem;
        }
        
        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3);
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading" class="loading-screen">
        <div class="spinner"></div>
        <div id="loading-text">Loading Content...</div>
    </div>

    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Navigation -->
    <nav class="main-nav glassmorphism">
        <a href="index.html" class="nav-brand">
            <i class="fas fa-stream"></i>
            <span>Bantu Stream</span>
        </a>
        
        <div class="nav-center">
            <a href="index.html" class="nav-link"><i class="fas fa-home"></i> Home</a>
            <a href="explore.html" class="nav-link"><i class="fas fa-compass"></i> Explore</a>
            <a href="library.html" class="nav-link"><i class="fas fa-photo-video"></i> Library</a>
            <a href="subscriptions.html" class="nav-link"><i class="fas fa-users"></i> Subscriptions</a>
            <a href="content-detail.html" class="nav-link active"><i class="fas fa-play-circle"></i> Now Playing</a>
        </div>
        
        <div class="nav-right">
            <div class="search-box">
                <input type="text" placeholder="Search content...">
                <button><i class="fas fa-search"></i></button>
            </div>
            <a href="profile.html" class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="content-container">
        <!-- Content Detail Sections (Initially hidden) -->
        <div id="contentDetail" style="display: none;">
            <!-- Hero Section -->
            <section class="hero-section glassmorphism">
                <div class="hero-background" id="heroBackground"></div>
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <div class="hero-info">
                        <h1 id="contentTitle">Loading...</h1>
                        <div class="hero-meta">
                            <span class="meta-item" id="contentCreator">
                                <i class="fas fa-user"></i>
                                <span id="creatorName">Loading...</span>
                            </span>
                            <span class="meta-item" id="contentViews">
                                <i class="fas fa-eye"></i>
                                <span id="viewsCount">0 views</span>
                            </span>
                            <span class="meta-item" id="contentLikes">
                                <i class="fas fa-heart"></i>
                                <span id="likesCount">0 likes</span>
                            </span>
                            <span class="meta-item" id="contentDurationDisplay">
                                <i class="fas fa-clock"></i>
                                <span id="durationText">-</span>
                            </span>
                        </div>
                        <div class="hero-actions">
                            <button class="glass-btn play-btn" id="playBtn">
                                <i class="fas fa-play"></i>
                                <span>Play Now</span>
                            </button>
                            <button class="glass-btn" id="downloadBtn">
                                <i class="fas fa-download"></i>
                                <span>Download</span>
                            </button>
                            <button class="glass-btn" id="favoriteBtn">
                                <i class="far fa-heart"></i>
                                <span>Favorite</span>
                            </button>
                            <button class="glass-btn" id="shareBtn">
                                <i class="fas fa-share"></i>
                                <span>Share</span>
                            </button>
                        </div>
                    </div>
                    <div class="hero-poster glassmorphism-gold">
                        <div class="poster-placeholder" id="posterPlaceholder">
                            <i class="fas fa-play-circle"></i>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Content Info Section -->
            <section class="info-section glassmorphism">
                <div class="section-title">
                    <i class="fas fa-info-circle"></i>
                    <span>About this content</span>
                </div>
                
                <div class="creator-info" id="creatorInfo">
                    <div class="creator-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="creator-details">
                        <h3 id="creatorDisplayName">Creator Name</h3>
                        <p id="creatorSubscribers">0 subscribers</p>
                    </div>
                    <button class="subscribe-btn" id="subscribeBtn">
                        <i class="fas fa-user-plus"></i>
                        <span>Subscribe</span>
                    </button>
                </div>
                
                <div class="info-stats glassmorphism">
                    <div class="stat-item">
                        <i class="fas fa-calendar-alt"></i>
                        <div>
                            <div style="color: var(--slate-grey); font-size: 0.8rem;">Uploaded</div>
                            <div id="uploadDate">-</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-film"></i>
                        <div>
                            <div style="color: var(--slate-grey); font-size: 0.8rem;">Duration</div>
                            <div id="contentDuration">-</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-tag"></i>
                        <div>
                            <div style="color: var(--slate-grey); font-size: 0.8rem;">Genre</div>
                            <div id="contentGenre">-</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-flag"></i>
                        <div>
                            <div style="color: var(--slate-grey); font-size: 0.8rem;">Language</div>
                            <div id="contentLanguage">-</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Description Section -->
            <section class="description-section glassmorphism">
                <div class="section-title">
                    <i class="fas fa-align-left"></i>
                    <span>Description</span>
                </div>
                <div class="description-content">
                    <p id="contentDescription">Loading description...</p>
                    <button class="show-more-btn" id="showMoreBtn" style="display: none;">Show more</button>
                </div>
            </section>

            <!-- Comments Section -->
            <section class="comments-section glassmorphism">
                <div class="comments-header">
                    <div class="section-title">
                        <i class="fas fa-comments"></i>
                        <span>Comments</span>
                        <span id="commentsCount" style="font-size: 1rem; color: var(--slate-grey); margin-left: 0.5rem;">(0)</span>
                    </div>
                    <button class="refresh-btn" id="refreshCommentsBtn">
                        <i class="fas fa-sync-alt"></i>
                        <span>Refresh</span>
                    </button>
                </div>
                
                <!-- Add Comment Form -->
                <div class="add-comment glassmorphism">
                    <div class="comment-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="comment-input-container">
                        <textarea 
                            id="commentInput" 
                            placeholder="Add a comment..." 
                            rows="2"
                        ></textarea>
                        <button class="send-comment-btn" id="sendCommentBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Comments List -->
                <div class="comments-list" id="commentsList">
                    <div class="no-comments" id="noComments">
                        <i class="far fa-comment-alt"></i>
                        <p>No comments yet. Be the first to comment!</p>
                    </div>
                    <!-- Comments will be dynamically inserted here -->
                </div>
            </section>

            <!-- Related Content Section -->
            <section class="related-section glassmorphism">
                <div class="section-title">
                    <i class="fas fa-video"></i>
                    <span>More Like This</span>
                </div>
                <div class="related-grid" id="relatedGrid">
                    <div class="related-placeholder">
                        <i class="fas fa-video"></i>
                        <p>Loading related content...</p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal for Edit Comment -->
    <div class="modal-overlay" id="editCommentModal">
        <div class="modal-container glassmorphism">
            <div class="modal-header">
                <h3>Edit Comment</h3>
                <button class="modal-close" id="closeEditModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <textarea 
                    id="editCommentInput" 
                    placeholder="Edit your comment..." 
                    rows="4"
                ></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn" id="cancelEditBtn">Cancel</button>
                <button class="modal-btn save-btn" id="saveEditBtn">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Modal for Delete Confirmation -->
    <div class="modal-overlay" id="deleteCommentModal">
        <div class="modal-container glassmorphism">
            <div class="modal-header">
                <h3>Delete Comment</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this comment? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn" id="cancelDeleteBtn">Cancel</button>
                <button class="modal-btn delete-btn" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Download Modal -->
    <div class="modal-overlay" id="downloadModal">
        <div class="modal-container glassmorphism">
            <div class="modal-header">
                <h3>Download Content</h3>
                <button class="modal-close" id="closeDownloadModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="downloadModalText">Would you like to download this content for offline viewing?</p>
                <div class="download-info">
                    <i class="fas fa-info-circle"></i>
                    <p>File will be downloaded to your device's downloads folder.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel-btn" id="cancelDownloadBtn">Cancel</button>
                <button class="modal-btn download-confirm-btn" id="confirmDownloadBtn">Download</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" style="display: none;">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Import Supabase -->
    <script>
        // Simple Supabase REST client
        class SupabaseClient {
            constructor(url, key) {
                this.url = url;
                this.key = key;
                this.headers = {
                    'apikey': key,
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${key}`
                };
            }
            
            async getCurrentUser() {
                try {
                    const response = await fetch(`${this.url}/auth/v1/user`, {
                        headers: this.headers
                    });
                    
                    if (response.ok) {
                        const { user } = await response.json();
                        return user;
                    }
                    return null;
                } catch (error) {
                    console.error('Error getting current user:', error);
                    return null;
                }
            }
            
            async getContent(contentId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/Content?id=eq.${contentId}&select=*,creator:user_id(id,username,display_name,avatar_url,subscriber_count)`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data[0] || null;
                    }
                    return null;
                } catch (error) {
                    console.error('Error getting content:', error);
                    return null;
                }
            }
            
            async getSimilarContent(currentContentId, genre, limit = 6) {
                try {
                    let url = `${this.url}/rest/v1/Content?select=*,creator:user_id(username,display_name)&id=neq.${currentContentId}&limit=${limit}`;
                    
                    if (genre) {
                        url += `&genre=eq.${encodeURIComponent(genre)}`;
                    }
                    
                    const response = await fetch(url, { headers: this.headers });
                    
                    if (response.ok) {
                        return await response.json();
                    }
                    return [];
                } catch (error) {
                    console.error('Error getting similar content:', error);
                    return [];
                }
            }
            
            async getComments(contentId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/comments?content_id=eq.${contentId}&select=*,user:user_id(id,username,display_name,avatar_url)&order=created_at.desc`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        return await response.json();
                    }
                    return [];
                } catch (error) {
                    console.error('Error getting comments:', error);
                    return [];
                }
            }
            
            async addComment(contentId, userId, commentText, authorName) {
                try {
                    const response = await fetch(`${this.url}/rest/v1/comments`, {
                        method: 'POST',
                        headers: this.headers,
                        body: JSON.stringify({
                            content_id: contentId,
                            user_id: userId,
                            author_name: authorName,
                            comment_text: commentText,
                            created_at: new Date().toISOString()
                        })
                    });
                    
                    return response.ok;
                } catch (error) {
                    console.error('Error adding comment:', error);
                    return false;
                }
            }
            
            async updateComment(commentId, commentText) {
                try {
                    const response = await fetch(`${this.url}/rest/v1/comments?id=eq.${commentId}`, {
                        method: 'PATCH',
                        headers: this.headers,
                        body: JSON.stringify({
                            comment_text: commentText,
                            updated_at: new Date().toISOString()
                        })
                    });
                    
                    return response.ok;
                } catch (error) {
                    console.error('Error updating comment:', error);
                    return false;
                }
            }
            
            async deleteComment(commentId) {
                try {
                    const response = await fetch(`${this.url}/rest/v1/comments?id=eq.${commentId}`, {
                        method: 'DELETE',
                        headers: this.headers
                    });
                    
                    return response.ok;
                } catch (error) {
                    console.error('Error deleting comment:', error);
                    return false;
                }
            }
            
            async getFavorites(userId, contentId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/favorites?user_id=eq.${userId}&content_id=eq.${contentId}`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data.length > 0 ? data[0] : null;
                    }
                    return null;
                } catch (error) {
                    console.error('Error getting favorites:', error);
                    return null;
                }
            }
            
            async toggleFavorite(contentId, userId) {
                try {
                    const existing = await this.getFavorites(userId, contentId);
                    
                    if (existing) {
                        // Remove from favorites
                        const response = await fetch(`${this.url}/rest/v1/favorites?id=eq.${existing.id}`, {
                            method: 'DELETE',
                            headers: this.headers
                        });
                        return response.ok;
                    } else {
                        // Add to favorites
                        const response = await fetch(`${this.url}/rest/v1/favorites`, {
                            method: 'POST',
                            headers: this.headers,
                            body: JSON.stringify({
                                content_id: contentId,
                                user_id: userId,
                                created_at: new Date().toISOString()
                            })
                        });
                        return response.ok;
                    }
                } catch (error) {
                    console.error('Error toggling favorite:', error);
                    return false;
                }
            }
            
            async recordView(contentId, userId) {
                try {
                    const response = await fetch(`${this.url}/rest/v1/content_views`, {
                        method: 'POST',
                        headers: this.headers,
                        body: JSON.stringify({
                            content_id: contentId,
                            viewer_id: userId,
                            device_type: 'web',
                            created_at: new Date().toISOString()
                        })
                    });
                    
                    return response.ok;
                } catch (error) {
                    console.error('Error recording view:', error);
                    return false;
                }
            }
            
            async getContentViews(contentId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/content_views?content_id=eq.${contentId}&select=id`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data.length;
                    }
                    return 0;
                } catch (error) {
                    console.error('Error getting content views:', error);
                    return 0;
                }
            }
            
            async getContentLikes(contentId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/content_likes?content_id=eq.${contentId}&select=id`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data.length;
                    }
                    return 0;
                } catch (error) {
                    console.error('Error getting content likes:', error);
                    return 0;
                }
            }
            
            async getUserLike(contentId, userId) {
                try {
                    const response = await fetch(
                        `${this.url}/rest/v1/content_likes?content_id=eq.${contentId}&user_id=eq.${userId}`,
                        { headers: this.headers }
                    );
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data.length > 0;
                    }
                    return false;
                } catch (error) {
                    console.error('Error getting user like:', error);
                    return false;
                }
            }
            
            async toggleLike(contentId, userId) {
                try {
                    const userLiked = await this.getUserLike(contentId, userId);
                    
                    if (userLiked) {
                        // Unlike
                        const response = await fetch(
                            `${this.url}/rest/v1/content_likes?content_id=eq.${contentId}&user_id=eq.${userId}`,
                            {
                                method: 'DELETE',
                                headers: this.headers
                            }
                        );
                        return { success: response.ok, liked: false };
                    } else {
                        // Like
                        const response = await fetch(`${this.url}/rest/v1/content_likes`, {
                            method: 'POST',
                            headers: this.headers,
                            body: JSON.stringify({
                                content_id: contentId,
                                user_id: userId,
                                created_at: new Date().toISOString()
                            })
                        });
                        return { success: response.ok, liked: true };
                    }
                } catch (error) {
                    console.error('Error toggling like:', error);
                    return { success: false, liked: false };
                }
            }
            
            fixMediaUrl(url) {
                if (!url) return '';
                if (url.startsWith('http')) return url;
                return `https://ydnxqnbjoshvxteevemc.supabase.co/storage/v1/object/public/${url.replace(/^\/+/, '')}`;
            }
        }
        
        // Initialize Supabase client
        const supabase = new SupabaseClient(
            'https://ydnxqnbjoshvxteevemc.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZWV2ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U'
        );
        
        console.log(' Supabase client initialized');
    </script>

    <!-- Content Detail JavaScript -->
    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', () => {
            console.log(' Content Detail Screen Initializing...');
            
            // Global variables
            let currentUser = null;
            let contentData = null;
            let comments = [];
            let relatedContent = [];
            let editingCommentId = null;
            let deletingCommentId = null;
            let currentContentId = null;
            let isSubscribed = false;
            let isInFavorites = false;
            let isLiked = false;
            let isLoading = false;
            
            // DOM Elements
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');
            const contentDetail = document.getElementById('contentDetail');
            
            // Hero Section Elements
            const heroBackground = document.getElementById('heroBackground');
            const posterPlaceholder = document.getElementById('posterPlaceholder');
            const contentTitle = document.getElementById('contentTitle');
            const creatorName = document.getElementById('creatorName');
            const viewsCount = document.getElementById('viewsCount');
            const likesCount = document.getElementById('likesCount');
            const durationText = document.getElementById('durationText');
            
            // Buttons
            const playBtn = document.getElementById('playBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const favoriteBtn = document.getElementById('favoriteBtn');
            const shareBtn = document.getElementById('shareBtn');
            
            // Content Info Elements
            const creatorDisplayName = document.getElementById('creatorDisplayName');
            const creatorSubscribers = document.getElementById('creatorSubscribers');
            const subscribeBtn = document.getElementById('subscribeBtn');
            const uploadDate = document.getElementById('uploadDate');
            const contentDuration = document.getElementById('contentDuration');
            const contentGenre = document.getElementById('contentGenre');
            const contentLanguage = document.getElementById('contentLanguage');
            const contentDescription = document.getElementById('contentDescription');
            const showMoreBtn = document.getElementById('showMoreBtn');
            
            // Comments Elements
            const refreshCommentsBtn = document.getElementById('refreshCommentsBtn');
            const commentInput = document.getElementById('commentInput');
            const sendCommentBtn = document.getElementById('sendCommentBtn');
            const commentsList = document.getElementById('commentsList');
            const noComments = document.getElementById('noComments');
            const commentsCount = document.getElementById('commentsCount');
            
            // Related Content
            const relatedGrid = document.getElementById('relatedGrid');
            
            // Modal Elements
            const editCommentModal = document.getElementById('editCommentModal');
            const editCommentInput = document.getElementById('editCommentInput');
            const closeEditModal = document.getElementById('closeEditModal');
            const cancelEditBtn = document.getElementById('cancelEditBtn');
            const saveEditBtn = document.getElementById('saveEditBtn');
            
            const deleteCommentModal = document.getElementById('deleteCommentModal');
            const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            
            const downloadModal = document.getElementById('downloadModal');
            const closeDownloadModal = document.getElementById('closeDownloadModal');
            const cancelDownloadBtn = document.getElementById('cancelDownloadBtn');
            const confirmDownloadBtn = document.getElementById('confirmDownloadBtn');
            const downloadModalText = document.getElementById('downloadModalText');
            
            // Toast Container
            const toastContainer = document.getElementById('toast-container');
            
            // Back to Top Button
            const backToTopBtn = document.getElementById('backToTop');
            
            //  INITIALIZE
            async function init() {
                try {
                    // Get current user
                    currentUser = await supabase.getCurrentUser();
                    console.log(' Current user:', currentUser?.email || 'Not logged in');
                    
                    // Get content ID from URL
                    const urlParams = new URLSearchParams(window.location.search);
                    currentContentId = urlParams.get('id');
                    
                    if (!currentContentId) {
                        showToast('No content ID provided', 'error');
                        setTimeout(() => window.location.href = 'index.html', 2000);
                        return;
                    }
                    
                    console.log(' Loading content ID:', currentContentId);
                    
                    // Load content data
                    await loadContentData();
                    
                    // Load additional data in parallel
                    await Promise.all([
                        loadRelatedContent(),
                        loadComments(),
                        loadEngagementData(),
                        loadFavoritesStatus()
                    ]);
                    
                    // Show content detail
                    loading.style.display = 'none';
                    contentDetail.style.display = 'block';
                    
                    // Set up event listeners
                    setupEventListeners();
                    
                    // Initialize back to top button
                    initBackToTop();
                    
                    console.log(' Content detail initialized successfully');
                    
                } catch (error) {
                    console.error(' Initialization error:', error);
                    showToast('Failed to load content', 'error');
                    loadingText.textContent = 'Error loading content. Please try again.';
                }
            }
            
            //  LOAD CONTENT DATA
            async function loadContentData() {
                try {
                    loadingText.textContent = 'Loading content details...';
                    
                    contentData = await supabase.getContent(currentContentId);
                    
                    if (!contentData) {
                        throw new Error('Content not found');
                    }
                    
                    console.log(' Content loaded:', contentData.title);
                    
                    // Update UI with content data
                    updateContentUI();
                    
                } catch (error) {
                    console.error(' Error loading content:', error);
                    showToast('Content not found', 'error');
                    throw error;
                }
            }
            
            //  UPDATE CONTENT UI
            function updateContentUI() {
                if (!contentData) return;
                
                // Update hero section
                contentTitle.textContent = contentData.title || 'Untitled';
                
                const creator = contentData.creator?.display_name || 
                               contentData.creator?.username || 
                               'Unknown Creator';
                creatorName.textContent = creator;
                
                // Set background image
                if (contentData.thumbnail_url) {
                    const thumbnailUrl = supabase.fixMediaUrl(contentData.thumbnail_url);
                    heroBackground.style.backgroundImage = `url('${thumbnailUrl}')`;
                    
                    // Update poster
                    posterPlaceholder.innerHTML = `<img src="${thumbnailUrl}" alt="${contentData.title}" style="width: 100%; height: 100%; object-fit: cover;">`;
                }
                
                // Update content info
                creatorDisplayName.textContent = creator;
                creatorSubscribers.textContent = `${contentData.creator?.subscriber_count || 0} subscribers`;
                
                uploadDate.textContent = formatDate(contentData.created_at);
                
                if (contentData.duration) {
                    const durationFormatted = formatDuration(contentData.duration);
                    contentDuration.textContent = durationFormatted;
                    durationText.textContent = durationFormatted;
                }
                
                contentGenre.textContent = contentData.genre || 'Not specified';
                contentLanguage.textContent = contentData.language || 'Unknown';
                
                // Update description
                const description = contentData.description || 'No description available.';
                contentDescription.textContent = description;
                
                // Show more/less button for long descriptions
                if (description.length > 300) {
                    showMoreBtn.style.display = 'block';
                    contentDescription.textContent = description.substring(0, 300) + '...';
                    showMoreBtn.textContent = 'Show more';
                }
            }
            
            //  LOAD ENGAGEMENT DATA
            async function loadEngagementData() {
                try {
                    // Get view count
                    const viewCount = await supabase.getContentViews(currentContentId);
                    viewsCount.textContent = `${viewCount} views`;
                    
                    // Get like count
                    const likeCount = await supabase.getContentLikes(currentContentId);
                    likesCount.textContent = `${likeCount} likes`;
                    
                    // Check if current user has liked this content
                    if (currentUser) {
                        isLiked = await supabase.getUserLike(currentContentId, currentUser.id);
                        if (isLiked) {
                            favoriteBtn.querySelector('i').className = 'fas fa-heart';
                            favoriteBtn.querySelector('span').textContent = 'Liked';
                        }
                    }
                    
                } catch (error) {
                    console.error(' Error loading engagement data:', error);
                }
            }
            
            //  LOAD FAVORITES STATUS
            async function loadFavoritesStatus() {
                try {
                    if (!currentUser) return;
                    
                    const favorite = await supabase.getFavorites(currentUser.id, currentContentId);
                    isInFavorites = !!favorite;
                    
                    if (isInFavorites) {
                        favoriteBtn.querySelector('i').className = 'fas fa-heart';
                        favoriteBtn.querySelector('span').textContent = 'Favorited';
                        favoriteBtn.style.background = 'rgba(245, 158, 11, 0.2)';
                    }
                    
                } catch (error) {
                    console.error(' Error loading favorites status:', error);
                }
            }
            
            //  LOAD RELATED CONTENT
            async function loadRelatedContent() {
                try {
                    const currentGenre = contentData?.genre;
                    
                    relatedContent = await supabase.getSimilarContent(
                        currentContentId,
                        currentGenre,
                        6
                    );
                    
                    renderRelatedContent();
                    
                } catch (error) {
                    console.error(' Error loading related content:', error);
                    relatedGrid.innerHTML = `
                        <div class="related-placeholder">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Failed to load related content</p>
                        </div>
                    `;
                }
            }
            
            //  RENDER RELATED CONTENT
            function renderRelatedContent() {
                if (!relatedContent.length) {
                    relatedGrid.innerHTML = `
                        <div class="related-placeholder">
                            <i class="fas fa-video-slash"></i>
                            <p>No related content found</p>
                        </div>
                    `;
                    return;
                }
                
                relatedGrid.innerHTML = '';
                relatedContent.forEach(content => {
                    const card = document.createElement('a');
                    card.className = 'related-card glassmorphism';
                    card.href = `content-detail.html?id=${content.id}`;
                    card.innerHTML = `
                        <div class="related-thumbnail">
                            ${content.thumbnail_url ? 
                                `<img src="${supabase.fixMediaUrl(content.thumbnail_url)}" alt="${content.title}" loading="lazy">` :
                                `<i class="fas fa-play-circle"></i>`
                            }
                        </div>
                        <div class="related-info">
                            <h3>${content.title || 'Untitled'}</h3>
                            <div class="related-meta">
                                <i class="fas fa-eye"></i>
                                <span>${content.views_count || 0} views</span>
                            </div>
                        </div>
                    `;
                    
                    relatedGrid.appendChild(card);
                });
            }
            
            //  LOAD COMMENTS
            async function loadComments() {
                try {
                    comments = await supabase.getComments(currentContentId);
                    renderComments();
                    
                } catch (error) {
                    console.error(' Error loading comments:', error);
                    commentsList.innerHTML = `
                        <div class="no-comments">
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>Failed to load comments</p>
                        </div>
                    `;
                }
            }
            
            //  RENDER COMMENTS
            function renderComments() {
                if (!comments.length) {
                    noComments.style.display = 'block';
                    commentsCount.textContent = '(0)';
                    return;
                }
                
                noComments.style.display = 'none';
                commentsCount.textContent = `(${comments.length})`;
                
                // Clear existing comments except no-comments placeholder
                const existingComments = commentsList.querySelectorAll('.comment-item');
                existingComments.forEach(comment => comment.remove());
                
                comments.forEach(comment => {
                    const commentEl = document.createElement('div');
                    commentEl.className = 'comment-item glassmorphism';
                    commentEl.dataset.commentId = comment.id;
                    
                    const userName = comment.user?.display_name || 
                                   comment.user?.username || 
                                   comment.author_name || 
                                   'User';
                    const userAvatar = comment.user?.avatar_url || comment.author_avatar;
                    const isOwner = currentUser && comment.user_id === currentUser.id;
                    const createdAt = comment.created_at ? formatCommentTime(comment.created_at) : 'Recently';
                    
                    commentEl.innerHTML = `
                        <div class="comment-header">
                            <div class="comment-avatar-sm">
                                ${userAvatar ? 
                                    `<img src="${supabase.fixMediaUrl(userAvatar)}" alt="${userName}" style="width: 30px; height: 30px; border-radius: 50%;">` :
                                    `<i class="fas fa-user-circle"></i>`
                                }
                            </div>
                            <div class="comment-user">
                                <strong>${userName}</strong>
                                <div class="comment-time">${createdAt}</div>
                            </div>
                            <div class="comment-actions">
                                ${isOwner ? `
                                    <button class="comment-action-btn edit-btn" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="comment-action-btn delete-btn" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                ` : ''}
                                <button class="comment-action-btn like-btn" title="Like">
                                    <i class="far fa-heart"></i>
                                </button>
                            </div>
                        </div>
                        <div class="comment-content">
                            ${comment.comment_text || comment.comment || ''}
                        </div>
                        <div class="comment-footer">
                            <div class="like-count">
                                <i class="fas fa-heart"></i>
                                <span>${comment.like_count || 0} likes</span>
                            </div>
                        </div>
                    `;
                    
                    // Add event listeners
                    const editBtn = commentEl.querySelector('.edit-btn');
                    const deleteBtn = commentEl.querySelector('.delete-btn');
                    const likeBtn = commentEl.querySelector('.like-btn');
                    
                    if (editBtn) {
                        editBtn.addEventListener('click', () => editComment(comment.id, comment.comment_text || comment.comment));
                    }
                    
                    if (deleteBtn) {
                        deleteBtn.addEventListener('click', () => confirmDeleteComment(comment.id));
                    }
                    
                    if (likeBtn) {
                        likeBtn.addEventListener('click', () => toggleCommentLike(comment.id, likeBtn));
                    }
                    
                    commentsList.appendChild(commentEl);
                });
            }
            
            //  SETUP EVENT LISTENERS
            function setupEventListeners() {
                // Play button
                playBtn.addEventListener('click', handlePlayPressed);
                
                // Download button
                downloadBtn.addEventListener('click', handleDownloadPressed);
                
                // Favorite button
                favoriteBtn.addEventListener('click', toggleFavorite);
                
                // Share button
                shareBtn.addEventListener('click', shareContent);
                
                // Subscribe button
                subscribeBtn.addEventListener('click', toggleSubscription);
                
                // Refresh comments button
                refreshCommentsBtn.addEventListener('click', () => {
                    if (isLoading) return;
                    loadComments();
                    showToast('Comments refreshed', 'success');
                });
                
                // Send comment button
                sendCommentBtn.addEventListener('click', addComment);
                
                // Comment input enter key
                commentInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        addComment();
                    }
                });
                
                // Show more button
                showMoreBtn.addEventListener('click', toggleDescription);
                
                // Edit comment modal
                closeEditModal.addEventListener('click', () => editCommentModal.style.display = 'none');
                cancelEditBtn.addEventListener('click', () => editCommentModal.style.display = 'none');
                saveEditBtn.addEventListener('click', saveEditedComment);
                
                // Delete comment modal
                cancelDeleteBtn.addEventListener('click', () => deleteCommentModal.style.display = 'none');
                confirmDeleteBtn.addEventListener('click', deleteComment);
                
                // Download modal
                closeDownloadModal.addEventListener('click', () => downloadModal.style.display = 'none');
                cancelDownloadBtn.addEventListener('click', () => downloadModal.style.display = 'none');
                confirmDownloadBtn.addEventListener('click', startDownload);
                
                // Close modals when clicking outside
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            modal.style.display = 'none';
                        }
                    });
                });
            }
            
            //  HANDLE PLAY PRESSED
            async function handlePlayPressed() {
                if (!contentData) return;
                
                // Record view
                if (currentUser) {
                    await supabase.recordView(currentContentId, currentUser.id);
                }
                
                // Navigate to video player
                const videoUrl = contentData.file_url ? supabase.fixMediaUrl(contentData.file_url) : '';
                window.location.href = `video-player.html?id=${currentContentId}&title=${encodeURIComponent(contentData.title)}&video=${encodeURIComponent(videoUrl)}`;
            }
            
            //  HANDLE DOWNLOAD PRESSED
            function handleDownloadPressed() {
                if (!contentData) return;
                
                if (contentData.isDownloaded) {
                    showToast('Content is already downloaded', 'info');
                    return;
                }
                
                downloadModalText.textContent = `Download "${contentData.title}" for offline viewing?`;
                downloadModal.style.display = 'flex';
            }
            
            //  START DOWNLOAD
            function startDownload() {
                downloadModal.style.display = 'none';
                
                // Show download progress
                showToast('Download started...', 'info');
                
                // Simulate download (in real app, this would be actual download logic)
                setTimeout(() => {
                    contentData.isDownloaded = true;
                    showToast('Download completed successfully!', 'success');
                }, 3000);
            }
            
            //  TOGGLE FAVORITE
            async function toggleFavorite() {
                if (!currentUser) {
                    showToast('Please sign in to add to favorites', 'warning');
                    return;
                }
                
                try {
                    const success = await supabase.toggleFavorite(currentContentId, currentUser.id);
                    
                    if (success) {
                        isInFavorites = !isInFavorites;
                        
                        if (isInFavorites) {
                            favoriteBtn.querySelector('i').className = 'fas fa-heart';
                            favoriteBtn.querySelector('span').textContent = 'Favorited';
                            favoriteBtn.style.background = 'rgba(245, 158, 11, 0.2)';
                            showToast('Added to favorites', 'success');
                        } else {
                            favoriteBtn.querySelector('i').className = 'far fa-heart';
                            favoriteBtn.querySelector('span').textContent = 'Favorite';
                            favoriteBtn.style.background = '';
                            showToast('Removed from favorites', 'info');
                        }
                    } else {
                        showToast('Failed to update favorites', 'error');
                    }
                    
                } catch (error) {
                    console.error(' Error toggling favorite:', error);
                    showToast('Failed to update favorites', 'error');
                }
            }
            
            //  SHARE CONTENT
            function shareContent() {
                if (!contentData) return;
                
                const shareData = {
                    title: contentData.title,
                    text: `Check out "${contentData.title}" on Bantu Stream Connect`,
                    url: window.location.href
                };
                
                if (navigator.share) {
                    navigator.share(shareData)
                        .then(() => showToast('Shared successfully!', 'success'))
                        .catch(err => {
                            if (err.name !== 'AbortError') {
                                copyToClipboard(window.location.href);
                            }
                        });
                } else {
                    copyToClipboard(window.location.href);
                }
            }
            
            //  TOGGLE SUBSCRIPTION
            async function toggleSubscription() {
                if (!currentUser) {
                    showToast('Please sign in to subscribe', 'warning');
                    return;
                }
                
                // For now, simulate subscription toggle
                isSubscribed = !isSubscribed;
                
                if (isSubscribed) {
                    subscribeBtn.innerHTML = '<i class="fas fa-user-check"></i><span>Subscribed</span>';
                    subscribeBtn.classList.add('subscribed');
                    showToast('Subscribed successfully!', 'success');
                } else {
                    subscribeBtn.innerHTML = '<i class="fas fa-user-plus"></i><span>Subscribe</span>';
                    subscribeBtn.classList.remove('subscribed');
                    showToast('Unsubscribed', 'info');
                }
            }
            
            //  ADD COMMENT
            async function addComment() {
                const commentText = commentInput.value.trim();
                if (!commentText) {
                    showToast('Please enter a comment', 'warning');
                    return;
                }
                
                if (!currentUser) {
                    showToast('Please sign in to comment', 'warning');
                    return;
                }
                
                isLoading = true;
                sendCommentBtn.disabled = true;
                sendCommentBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                
                try {
                    const userName = currentUser.user_metadata?.full_name || 
                                   currentUser.user_metadata?.username || 
                                   currentUser.email?.split('@')[0] || 
                                   'User';
                    
                    const success = await supabase.addComment(
                        currentContentId,
                        currentUser.id,
                        commentText,
                        userName
                    );
                    
                    if (success) {
                        // Clear input and refresh comments
                        commentInput.value = '';
                        await loadComments();
                        showToast('Comment added successfully!', 'success');
                    } else {
                        showToast('Failed to add comment', 'error');
                    }
                    
                } catch (error) {
                    console.error(' Error adding comment:', error);
                    showToast('Failed to add comment', 'error');
                } finally {
                    isLoading = false;
                    sendCommentBtn.disabled = false;
                    sendCommentBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                }
            }
            
            //  TOGGLE COMMENT LIKE
            async function toggleCommentLike(commentId, likeBtn) {
                if (!currentUser) {
                    showToast('Please sign in to like comments', 'warning');
                    return;
                }
                
                // For now, simulate comment like
                const heartIcon = likeBtn.querySelector('i');
                const isLiked = heartIcon.classList.contains('fas');
                
                if (isLiked) {
                    heartIcon.className = 'far fa-heart';
                    likeBtn.classList.remove('liked');
                } else {
                    heartIcon.className = 'fas fa-heart';
                    likeBtn.classList.add('liked');
                }
            }
            
            //  EDIT COMMENT
            function editComment(commentId, currentText) {
                editingCommentId = commentId;
                editCommentInput.value = currentText;
                editCommentModal.style.display = 'flex';
            }
            
            //  SAVE EDITED COMMENT
            async function saveEditedComment() {
                if (!editingCommentId || !editCommentInput.value.trim()) {
                    editCommentModal.style.display = 'none';
                    return;
                }
                
                try {
                    const success = await supabase.updateComment(
                        editingCommentId,
                        editCommentInput.value.trim()
                    );
                    
                    if (success) {
                        // Update locally and refresh
                        const comment = comments.find(c => c.id === editingCommentId);
                        if (comment) {
                            comment.comment_text = editCommentInput.value.trim();
                        }
                        
                        editCommentModal.style.display = 'none';
                        editCommentInput.value = '';
                        editingCommentId = null;
                        
                        renderComments();
                        showToast('Comment updated successfully!', 'success');
                    } else {
                        showToast('Failed to update comment', 'error');
                    }
                    
                } catch (error) {
                    console.error(' Error updating comment:', error);
                    showToast('Failed to update comment', 'error');
                }
            }
            
            //  CONFIRM DELETE COMMENT
            function confirmDeleteComment(commentId) {
                deletingCommentId = commentId;
                deleteCommentModal.style.display = 'flex';
            }
            
            //  DELETE COMMENT
            async function deleteComment() {
                if (!deletingCommentId) {
                    deleteCommentModal.style.display = 'none';
                    return;
                }
                
                try {
                    const success = await supabase.deleteComment(deletingCommentId);
                    
                    if (success) {
                        // Remove locally
                        comments = comments.filter(c => c.id !== deletingCommentId);
                        
                        deleteCommentModal.style.display = 'none';
                        deletingCommentId = null;
                        
                        renderComments();
                        showToast('Comment deleted successfully!', 'success');
                    } else {
                        showToast('Failed to delete comment', 'error');
                    }
                    
                } catch (error) {
                    console.error(' Error deleting comment:', error);
                    showToast('Failed to delete comment', 'error');
                }
            }
            
            //  TOGGLE DESCRIPTION
            function toggleDescription() {
                const fullDescription = contentData.description;
                const currentText = contentDescription.textContent;
                
                if (currentText.includes('...')) {
                    // Show full description
                    contentDescription.textContent = fullDescription;
                    showMoreBtn.textContent = 'Show less';
                } else {
                    // Show truncated description
                    contentDescription.textContent = fullDescription.substring(0, 300) + '...';
                    showMoreBtn.textContent = 'Show more';
                }
            }
            
            //  INIT BACK TO TOP BUTTON
            function initBackToTop() {
                window.addEventListener('scroll', () => {
                    if (window.pageYOffset > 300) {
                        backToTopBtn.style.display = 'flex';
                    } else {
                        backToTopBtn.style.display = 'none';
                    }
                });
                
                backToTopBtn.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }
            
            //  UTILITY FUNCTIONS
            
            function formatDate(dateString) {
                if (!dateString) return '-';
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            }
            
            function formatDuration(seconds) {
                if (!seconds) return '-';
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                const remainingSeconds = seconds % 60;
                
                if (hours > 0) {
                    return `${hours}h ${minutes}m`;
                } else if (minutes > 0) {
                    return `${minutes}m ${remainingSeconds}s`;
                } else {
                    return `${remainingSeconds}s`;
                }
            }
            
            function formatCommentTime(dateString) {
                if (!dateString) return 'Recently';
                
                try {
                    const date = new Date(dateString);
                    const now = new Date();
                    const diffMs = now - date;
                    const diffSec = Math.floor(diffMs / 1000);
                    const diffMin = Math.floor(diffSec / 60);
                    const diffHour = Math.floor(diffMin / 60);
                    const diffDay = Math.floor(diffHour / 24);
                    const diffMonth = Math.floor(diffDay / 30);
                    const diffYear = Math.floor(diffMonth / 12);
                    
                    if (diffYear > 0) return `${diffYear}y ago`;
                    if (diffMonth > 0) return `${diffMonth}mo ago`;
                    if (diffDay > 0) return `${diffDay}d ago`;
                    if (diffHour > 0) return `${diffHour}h ago`;
                    if (diffMin > 0) return `${diffMin}m ago`;
                    return 'Just now';
                } catch (e) {
                    return 'Recently';
                }
            }
            
            function showToast(message, type = 'info') {
                // Remove existing toast
                const existingToast = document.querySelector('.toast');
                if (existingToast) existingToast.remove();
                
                // Create new toast
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                let icon = 'info-circle';
                if (type === 'success') icon = 'check-circle';
                if (type === 'error') icon = 'exclamation-circle';
                if (type === 'warning') icon = 'exclamation-triangle';
                
                toast.innerHTML = `
                    <i class="fas fa-${icon}"></i>
                    <span>${message}</span>
                `;
                
                toastContainer.appendChild(toast);
                
                // Remove toast after 3 seconds
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.style.opacity = '0';
                        setTimeout(() => {
                            if (toast.parentNode) toast.remove();
                        }, 300);
                    }
                }, 3000);
            }
            
            function copyToClipboard(text) {
                navigator.clipboard.writeText(text)
                    .then(() => showToast('Link copied to clipboard!', 'success'))
                    .catch(err => {
                        console.error('Failed to copy:', err);
                        showToast('Failed to copy link', 'error');
                    });
            }
            
            //  START INITIALIZATION
            setTimeout(() => {
                init();
            }, 500);
            
            console.log(' Content detail script loaded');
        });
    </script>
</body>
</html>
