<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile & Settings - Bantu Stream Connect</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Color Theme (from Flutter app) */
        :root {
            --deep-black: #0A0E12;
            --deep-navy: #0F172A;
            --soft-white: #F8FAFC;
            --slate-grey: #94A3B8;
            --bantu-blue: #1D4ED8;
            --warm-gold: #F59E0B;
            --error-color: #EF4444;
            --success-color: #10B981;
            --glow-blue-1: #00A3FF;
            --glow-blue-2: #0066FF;
            --glow-purple: #8B5CF6;
            --glow-pink: #EC4899;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #001F54 0%, #0A0E3F 50%, #000000 100%);
            color: var(--soft-white);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #001F54 0%, #0A0E3F 50%, #000000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--warm-gold);
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Glassmorphism Effects */
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        /* Header */
        .header {
            background: rgba(0, 31, 84, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #4dabf7 0%, #748ffc 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: 600;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* Main Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* User Info Card */
        .user-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .avatar-container {
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .user-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid var(--warm-gold);
            object-fit: cover;
            box-shadow: 0 0 30px rgba(245, 158, 11, 0.3);
        }
        
        .avatar-edit-btn {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--warm-gold), #f97316);
            border: 3px solid rgba(0, 0, 0, 0.8);
            color: var(--deep-black);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .avatar-edit-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
        }
        
        .user-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--warm-gold);
        }
        
        .user-email {
            font-size: 16px;
            color: var(--slate-grey);
            margin-bottom: 20px;
        }
        
        .bio-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
        }
        
        .bio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .bio-title {
            font-weight: 600;
            color: var(--soft-white);
        }
        
        .bio-edit-btn {
            background: transparent;
            border: none;
            color: var(--warm-gold);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .bio-text {
            color: var(--slate-grey);
            line-height: 1.6;
            font-size: 14px;
        }
        
        .account-status {
            display: inline-block;
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 20px;
            font-weight: 500;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        /* Content Sections */
        .content-section {
            margin-bottom: 30px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .section-icon {
            color: var(--warm-gold);
            font-size: 20px;
        }
        
        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 20px;
            font-weight: 600;
        }
        
        /* Content Scroller */
        .content-scroller {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--warm-gold) rgba(255, 255, 255, 0.1);
        }
        
        .content-scroller::-webkit-scrollbar {
            height: 6px;
        }
        
        .content-scroller::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .content-scroller::-webkit-scrollbar-thumb {
            background: var(--warm-gold);
            border-radius: 3px;
        }
        
        .content-item {
            flex: 0 0 auto;
            width: 100px;
            text-decoration: none;
            color: inherit;
        }
        
        .content-thumbnail {
            width: 100px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .content-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .content-title {
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Empty State */
        .empty-state {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            color: var(--slate-grey);
        }
        
        .empty-icon {
            font-size: 40px;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        /* Settings Sections */
        .settings-section {
            margin-bottom: 30px;
        }
        
        .settings-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--slate-grey);
            margin-bottom: 12px;
            letter-spacing: 1px;
        }
        
        .settings-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
        }
        
        .settings-item:last-child {
            border-bottom: none;
        }
        
        .settings-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .settings-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        
        .settings-icon.email {
            background: rgba(77, 171, 247, 0.2);
            color: #4dabf7;
        }
        
        .settings-icon.security {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warm-gold);
        }
        
        .settings-icon.help {
            background: rgba(139, 92, 246, 0.2);
            color: var(--glow-purple);
        }
        
        .settings-content {
            flex: 1;
        }
        
        .settings-label {
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .settings-value {
            font-size: 14px;
            color: var(--slate-grey);
        }
        
        .settings-arrow {
            color: var(--slate-grey);
        }
        
        /* Danger Zone */
        .danger-zone {
            margin-top: 40px;
            margin-bottom: 100px;
        }
        
        .danger-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--error-color);
            margin-bottom: 12px;
            letter-spacing: 1px;
        }
        
        .danger-card {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 25px;
        }
        
        .danger-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .danger-icon {
            color: var(--error-color);
            font-size: 20px;
        }
        
        .danger-label {
            font-weight: 600;
            color: var(--error-color);
            font-size: 18px;
        }
        
        .danger-description {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 14px;
        }
        
        .delete-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--error-color), #c53030);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .delete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }
        
        .delete-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .warning-note {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
        }
        
        .toast.success {
            background: linear-gradient(135deg, #51cf66 0%, #2b8a3e 100%);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #4dabf7 0%, #748ffc 100%);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #001F54 0%, #0A0E3F 100%);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--soft-white);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-icon {
            color: var(--error-color);
        }
        
        .modal-list {
            margin: 20px 0;
        }
        
        .modal-list-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .modal-list-item .bullet {
            color: var(--error-color);
            font-weight: bold;
        }
        
        .modal-note {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .modal-email {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            word-break: break-all;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
        }
        
        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .modal-btn.cancel {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .modal-btn.cancel:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .modal-btn.delete {
            background: linear-gradient(135deg, var(--error-color), #c53030);
            color: white;
        }
        
        .modal-btn.delete:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }
        
        /* Bio Editor Modal */
        .bio-modal .modal-content {
            max-width: 400px;
        }
        
        .bio-textarea {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }
        
        .bio-textarea:focus {
            outline: none;
            border-color: var(--warm-gold);
        }
        
        .bio-counter {
            text-align: right;
            font-size: 12px;
            color: var(--slate-grey);
            margin-bottom: 20px;
        }
        
        /* Profile Picture Modal */
        .avatar-modal .modal-content {
            max-width: 400px;
            text-align: center;
        }
        
        .avatar-options {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }
        
        .avatar-option {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .avatar-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--warm-gold);
        }
        
        .avatar-option-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--warm-gold);
        }
        
        .avatar-option-label {
            font-weight: 500;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .user-card {
                padding: 30px 20px;
            }
            
            .user-name {
                font-size: 24px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .avatar-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading" class="loading-screen">
        <div class="spinner"></div>
        <div id="loading-text">Loading Profile...</div>
    </div>

    <!-- Delete Account Modal -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <h2 class="modal-title">
                <i class="fas fa-exclamation-triangle modal-icon"></i>
                Delete Account
            </h2>
            <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 20px;">
                This action will:
            </p>
            <div class="modal-list">
                <div class="modal-list-item">
                    <span class="bullet">â€¢</span>
                    <span>Sign you out immediately</span>
                </div>
                <div class="modal-list-item">
                    <span class="bullet">â€¢</span>
                    <span>Remove your access to the app</span>
                </div>
                <div class="modal-list-item">
                    <span class="bullet">â€¢</span>
                    <span>Require you to contact support for complete data deletion</span>
                </div>
            </div>
            <div class="modal-note">
                <i class="fas fa-info-circle" style="color: var(--warm-gold); margin-right: 8px;"></i>
                For complete data deletion, email us at:
            </div>
            <div class="modal-email">
                support@bantustreamconnect.com
            </div>
            <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 20px; font-weight: 500;">
                Are you sure you want to proceed?
            </p>
            <div class="modal-actions">
                <button id="cancel-delete-btn" class="modal-btn cancel">Cancel</button>
                <button id="confirm-delete-btn" class="modal-btn delete">Delete My Account</button>
            </div>
        </div>
    </div>

    <!-- Edit Bio Modal -->
    <div id="bio-modal" class="modal bio-modal">
        <div class="modal-content">
            <h2 class="modal-title">Edit Bio</h2>
            <textarea id="bio-textarea" class="bio-textarea" placeholder="Tell us about yourself..." maxlength="500"></textarea>
            <div class="bio-counter">
                <span id="bio-counter">0</span>/500 characters
            </div>
            <div class="modal-actions">
                <button id="cancel-bio-btn" class="modal-btn cancel">Cancel</button>
                <button id="save-bio-btn" class="modal-btn delete" style="background: linear-gradient(135deg, var(--warm-gold), #f97316);">Save</button>
            </div>
        </div>
    </div>

    <!-- Profile Picture Modal -->
    <div id="avatar-modal" class="modal avatar-modal">
        <div class="modal-content">
            <h2 class="modal-title">Change Profile Picture</h2>
            <div class="avatar-options">
                <div id="camera-option" class="avatar-option">
                    <div class="avatar-option-icon">
                        <i class="fas fa-camera"></i>
                    </div>
                    <div class="avatar-option-label">Camera</div>
                </div>
                <div id="gallery-option" class="avatar-option">
                    <div class="avatar-option-icon">
                        <i class="fas fa-images"></i>
                    </div>
                    <div class="avatar-option-label">Gallery</div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cancel-avatar-btn" class="modal-btn cancel">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Main Content (hidden until loaded) -->
    <div id="app" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-user-circle" style="color: white;"></i>
                </div>
                <div class="logo-text">Profile & Settings</div>
            </div>
            <div class="header-actions">
                <button id="back-btn" class="icon-btn" title="Go Back" onclick="window.history.back()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <button id="home-btn" class="icon-btn" title="Home" onclick="window.location.href='index.html'">
                    <i class="fas fa-home"></i>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container">
            <!-- User Info Card -->
            <div class="user-card glassmorphism">
                <div class="avatar-container">
                    <img id="user-avatar" class="user-avatar" src="" alt="User Avatar" 
                         onerror="this.src='https://images.unsplash.com/photo-1633332755192-727a05c4013d?w=400&h=400&fit=crop'">
                    <div id="edit-avatar-btn" class="avatar-edit-btn">
                        <i class="fas fa-camera"></i>
                    </div>
                </div>
                <h1 id="user-name" class="user-name">Loading...</h1>
                <p id="user-email" class="user-email">user@example.com</p>
                
                <div class="bio-section">
                    <div class="bio-header">
                        <div class="bio-title">Bio</div>
                        <button id="edit-bio-btn" class="bio-edit-btn">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                    </div>
                    <p id="user-bio" class="bio-text">No bio yet. Click edit to add a bio.</p>
                </div>
                
                <div id="account-status" class="account-status">
                    <i class="fas fa-check-circle"></i> Active Account
                </div>
            </div>

            <!-- Favorites Section -->
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-heart section-icon"></i>
                    <h2 class="section-title">My Favorites</h2>
                </div>
                
                <div id="favorites-scroller" class="content-scroller">
                    <!-- Favorites will be loaded here -->
                </div>
                
                <!-- Empty State (initially hidden) -->
                <div id="no-favorites" class="empty-state" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3>No Favorites Yet</h3>
                    <p>Content you favorite will appear here</p>
                </div>
            </div>

            <!-- Watch History Section -->
            <div class="content-section">
                <div class="section-header">
                    <i class="fas fa-history section-icon"></i>
                    <h2 class="section-title">Watch History</h2>
                </div>
                
                <div id="history-scroller" class="content-scroller">
                    <!-- Watch history will be loaded here -->
                </div>
                
                <!-- Empty State (initially hidden) -->
                <div id="no-history" class="empty-state" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3>No Watch History</h3>
                    <p>Videos you watch will appear here</p>
                </div>
            </div>

            <!-- Account Settings -->
            <div class="settings-section">
                <div class="settings-title">ACCOUNT SETTINGS</div>
                <div class="settings-card">
                    <a href="#" id="email-settings" class="settings-item">
                        <div class="settings-icon email">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="settings-content">
                            <div class="settings-label">Email</div>
                            <div id="email-value" class="settings-value">user@example.com</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                    
                    <a href="privacy-security.html" class="settings-item">
                        <div class="settings-icon security">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="settings-content">
                            <div class="settings-label">Privacy & Security</div>
                            <div class="settings-value">Manage your privacy settings</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                    
                    <a href="help-support.html" class="settings-item">
                        <div class="settings-icon help">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="settings-content">
                            <div class="settings-label">Help, Report & Support</div>
                            <div class="settings-value">Get help and report issues</div>
                        </div>
                        <div class="settings-arrow">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Danger Zone -->
            <div class="danger-zone">
                <div class="danger-title">DANGER ZONE</div>
                <div class="danger-card">
                    <div class="danger-header">
                        <i class="fas fa-exclamation-triangle danger-icon"></i>
                        <div class="danger-label">Delete Account</div>
                    </div>
                    <p class="danger-description">
                        Once you delete your account, you will be signed out immediately. 
                        For complete deletion of your personal data from our servers, 
                        you must contact our support team.
                    </p>
                    <button id="delete-account-btn" class="delete-btn">
                        <i class="fas fa-trash-alt"></i>
                        Delete My Account
                    </button>
                    <div class="warning-note">This action cannot be undone</div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- SIMPLE SUPABASE CLIENT -->
    <script>
        // Simple Supabase REST client
        class SimpleSupabaseClient {
            constructor(url, key) {
                this.url = url;
                this.key = key;
            }
            
            async query(table, options = {}) {
                const {
                    select = '*',
                    where = {},
                    orderBy = 'created_at',
                    order = 'desc',
                    limit = 100,
                    offset = 0
                } = options;
                
                // Build query URL
                let queryUrl = `${this.url}/rest/v1/${table}?select=${select}`;
                
                // Add filters
                Object.keys(where).forEach(key => {
                    queryUrl += `&${key}=eq.${encodeURIComponent(where[key])}`;
                });
                
                // Add ordering
                if (orderBy) {
                    queryUrl += `&order=${orderBy}.${order}`;
                }
                
                // Add limit and offset
                queryUrl += `&limit=${limit}&offset=${offset}`;
                
                try {
                    const response = await fetch(queryUrl, {
                        headers: {
                            'apikey': this.key,
                            'Authorization': `Bearer ${this.key}`,
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('Supabase query error:', error);
                    throw error;
                }
            }
            
            async update(table, where = {}, data = {}) {
                try {
                    // Build query URL
                    let queryUrl = `${this.url}/rest/v1/${table}`;
                    
                    // Add filters
                    const filterParams = [];
                    Object.keys(where).forEach(key => {
                        filterParams.push(`${key}=eq.${encodeURIComponent(where[key])}`);
                    });
                    
                    if (filterParams.length > 0) {
                        queryUrl += `?${filterParams.join('&')}`;
                    }
                    
                    const response = await fetch(queryUrl, {
                        method: 'PATCH',
                        headers: {
                            'apikey': this.key,
                            'Authorization': `Bearer ${this.key}`,
                            'Content-Type': 'application/json',
                            'Prefer': 'return=representation'
                        },
                        body: JSON.stringify(data)
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    console.error('Supabase update error:', error);
                    throw error;
                }
            }
            
            // Get current user session
            async getSession() {
                try {
                    // Check if we have a stored session
                    const session = localStorage.getItem('supabase.auth.token');
                    if (!session) return null;
                    
                    return JSON.parse(session);
                } catch (error) {
                    console.error('Error getting session:', error);
                    return null;
                }
            }
            
            // Get current user
            async getCurrentUser() {
                const session = await this.getSession();
                if (!session) return null;
                
                // Extract user from session
                try {
                    const sessionData = JSON.parse(session);
                    return sessionData.user || null;
                } catch (error) {
                    console.error('Error parsing user session:', error);
                    return null;
                }
            }
            
            // Get user profile
            async getUserProfile(userId) {
                try {
                    const profiles = await this.query('user_profiles', {
                        where: { user_id: userId },
                        limit: 1
                    });
                    
                    return profiles.length > 0 ? profiles[0] : null;
                } catch (error) {
                    console.error('Error getting user profile:', error);
                    return null;
                }
            }
            
            // Update user profile
            async updateUserProfile(userId, data) {
                try {
                    // Check if profile exists
                    const existingProfile = await this.getUserProfile(userId);
                    
                    if (existingProfile) {
                        // Update existing profile
                        return await this.update('user_profiles', { user_id: userId }, data);
                    } else {
                        // Create new profile
                        const response = await fetch(`${this.url}/rest/v1/user_profiles`, {
                            method: 'POST',
                            headers: {
                                'apikey': this.key,
                                'Authorization': `Bearer ${this.key}`,
                                'Content-Type': 'application/json',
                                'Prefer': 'return=representation'
                            },
                            body: JSON.stringify({
                                user_id: userId,
                                ...data
                            })
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        
                        return await response.json();
                    }
                } catch (error) {
                    console.error('Error updating user profile:', error);
                    throw error;
                }
            }
            
            // Get user favorites
            async getUserFavorites(userId) {
                try {
                    // This depends on your database structure
                    // Assuming a 'favorites' table with user_id and content_id
                    const favorites = await this.query('favorites', {
                        where: { user_id: userId },
                        limit: 20
                    });
                    
                    // Get content details for each favorite
                    const contentIds = favorites.map(f => f.content_id);
                    if (contentIds.length === 0) return [];
                    
                    let content = [];
                    try {
                        content = await this.query('Content', {
                            where: { id: { in: `(${contentIds.join(',')})` } },
                            limit: 20
                        });
                    } catch (error) {
                        content = await this.query('content', {
                            where: { id: { in: `(${contentIds.join(',')})` } },
                            limit: 20
                        });
                    }
                    
                    return content;
                } catch (error) {
                    console.error('Error getting user favorites:', error);
                    return [];
                }
            }
            
            // Get user watch history
            async getUserWatchHistory(userId) {
                try {
                    // This depends on your database structure
                    // Assuming a 'watch_history' table
                    const history = await this.query('watch_history', {
                        where: { user_id: userId },
                        orderBy: 'watched_at',
                        order: 'desc',
                        limit: 20
                    });
                    
                    // Get content details for each history item
                    const contentIds = history.map(h => h.content_id);
                    if (contentIds.length === 0) return [];
                    
                    let content = [];
                    try {
                        content = await this.query('Content', {
                            where: { id: { in: `(${contentIds.join(',')})` } },
                            limit: 20
                        });
                    } catch (error) {
                        content = await this.query('content', {
                            where: { id: { in: `(${contentIds.join(',')})` } },
                            limit: 20
                        });
                    }
                    
                    return content;
                } catch (error) {
                    console.error('Error getting watch history:', error);
                    return [];
                }
            }
            
            // Fix media URL helper
            fixMediaUrl(url) {
                if (!url) return '';
                if (url.startsWith('http')) return url;
                return `https://ydnxqnbjoshvxteevemc.supabase.co/storage/v1/object/public/${url.replace(/^\/+/, '')}`;
            }
            
            // Sign out user
            async signOut() {
                try {
                    // Clear local session
                    localStorage.removeItem('supabase.auth.token');
                    return true;
                } catch (error) {
                    console.error('Error signing out:', error);
                    return false;
                }
            }
        }
        
        // Initialize simple Supabase client
        const supabase = new SimpleSupabaseClient(
            'https://ydnxqnbjoshvxteevemc.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZWV2ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U'
        );
        
        console.log('âœ… Simple Supabase client initialized');
    </script>

    <!-- Profile Screen JavaScript -->
    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('ðŸ‘¤ Profile Screen Initializing...');
            
            // State variables
            let currentUser = null;
            let userProfile = null;
            let favorites = [];
            let watchHistory = [];
            let isLoading = true;
            let isDeleting = false;
            
            // DOM Elements
            const loadingScreen = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');
            const app = document.getElementById('app');
            const deleteModal = document.getElementById('delete-modal');
            const bioModal = document.getElementById('bio-modal');
            const avatarModal = document.getElementById('avatar-modal');
            
            // âœ… SHOW/HIDE LOADING
            function setLoading(loading, text = '') {
                isLoading = loading;
                if (text) loadingText.textContent = text;
                
                if (loading) {
                    loadingScreen.style.display = 'flex';
                    app.style.display = 'none';
                } else {
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                        app.style.display = 'block';
                    }, 500);
                }
            }
            
            // âœ… SHOW TOAST MESSAGE
            function showToast(message, type = 'error') {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.textContent = message;
                
                const container = document.getElementById('toast-container');
                container.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }
            
            // âœ… SHOW/HIDE MODAL
            function showModal(modal, show = true) {
                if (show) {
                    modal.classList.add('active');
                } else {
                    modal.classList.remove('active');
                }
            }
            
            // âœ… LOAD USER DATA
            async function loadUserData() {
                try {
                    // Check authentication
                    currentUser = await supabase.getCurrentUser();
                    
                    if (!currentUser) {
                        showToast('Please log in to view profile', 'error');
                        window.location.href = 'login.html?redirect=profile.html';
                        return;
                    }
                    
                    // Load user profile
                    loadingText.textContent = 'Loading profile...';
                    userProfile = await supabase.getUserProfile(currentUser.id);
                    
                    // Load favorites
                    loadingText.textContent = 'Loading favorites...';
                    favorites = await supabase.getUserFavorites(currentUser.id);
                    
                    // Load watch history
                    loadingText.textContent = 'Loading watch history...';
                    watchHistory = await supabase.getUserWatchHistory(currentUser.id);
                    
                    console.log('âœ… User data loaded:', {
                        userProfile,
                        favoritesCount: favorites.length,
                        historyCount: watchHistory.length
                    });
                    
                    // Update UI
                    updateUserInfo();
                    updateFavorites();
                    updateWatchHistory();
                    
                } catch (error) {
                    console.error('âŒ Error loading user data:', error);
                    showToast('Failed to load profile data', 'error');
                    
                    // Show test data for development
                    showTestData();
                }
            }
            
            // âœ… UPDATE USER INFO
            function updateUserInfo() {
                if (!currentUser || !userProfile) return;
                
                // Set user info
                const userName = userProfile.full_name || 
                                currentUser.user_metadata?.full_name || 
                                currentUser.email.split('@')[0];
                
                document.getElementById('user-name').textContent = userName;
                document.getElementById('user-email').textContent = currentUser.email;
                document.getElementById('email-value').textContent = currentUser.email;
                
                // Set bio
                const userBio = userProfile.bio || 'No bio yet. Click edit to add a bio.';
                document.getElementById('user-bio').textContent = userBio;
                
                // Set avatar
                if (userProfile.avatar_url) {
                    const avatarUrl = supabase.fixMediaUrl(userProfile.avatar_url);
                    document.getElementById('user-avatar').src = avatarUrl;
                }
            }
            
            // âœ… UPDATE FAVORITES
            function updateFavorites() {
                const favoritesScroller = document.getElementById('favorites-scroller');
                const noFavorites = document.getElementById('no-favorites');
                
                if (favorites.length === 0) {
                    favoritesScroller.style.display = 'none';
                    noFavorites.style.display = 'block';
                    return;
                }
                
                favoritesScroller.style.display = 'flex';
                noFavorites.style.display = 'none';
                
                // Clear existing
                favoritesScroller.innerHTML = '';
                
                // Add favorites
                favorites.forEach(item => {
                    const thumbnailUrl = item.thumbnail_url 
                        ? supabase.fixMediaUrl(item.thumbnail_url)
                        : 'https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?w=400&h=225&fit=crop';
                    
                    const contentItem = document.createElement('a');
                    contentItem.className = 'content-item';
                    contentItem.href = `content-detail.html?id=${item.id}`;
                    
                    contentItem.innerHTML = `
                        <div class="content-thumbnail">
                            <img src="${thumbnailUrl}" 
                                 alt="${item.title}"
                                 onerror="this.src='https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?w=400&h=225&fit=crop'">
                        </div>
                        <div class="content-title">${item.title || 'Untitled'}</div>
                    `;
                    
                    favoritesScroller.appendChild(contentItem);
                });
            }
            
            // âœ… UPDATE WATCH HISTORY
            function updateWatchHistory() {
                const historyScroller = document.getElementById('history-scroller');
                const noHistory = document.getElementById('no-history');
                
                if (watchHistory.length === 0) {
                    historyScroller.style.display = 'none';
                    noHistory.style.display = 'block';
                    return;
                }
                
                historyScroller.style.display = 'flex';
                noHistory.style.display = 'none';
                
                // Clear existing
                historyScroller.innerHTML = '';
                
                // Add history items
                watchHistory.forEach(item => {
                    const thumbnailUrl = item.thumbnail_url 
                        ? supabase.fixMediaUrl(item.thumbnail_url)
                        : 'https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?w=400&h=225&fit=crop';
                    
                    const contentItem = document.createElement('a');
                    contentItem.className = 'content-item';
                    contentItem.href = `content-detail.html?id=${item.id}`;
                    
                    contentItem.innerHTML = `
                        <div class="content-thumbnail">
                            <img src="${thumbnailUrl}" 
                                 alt="${item.title}"
                                 onerror="this.src='https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?w=400&h=225&fit=crop'">
                        </div>
                        <div class="content-title">${item.title || 'Untitled'}</div>
                    `;
                    
                    historyScroller.appendChild(contentItem);
                });
            }
            
            // âœ… UPDATE BIO
            async function updateBio(newBio) {
                try {
                    if (!currentUser) return;
                    
                    await supabase.updateUserProfile(currentUser.id, {
                        bio: newBio,
                        updated_at: new Date().toISOString()
                    });
                    
                    // Update local profile
                    if (!userProfile) {
                        userProfile = {};
                    }
                    userProfile.bio = newBio;
                    
                    // Update UI
                    updateUserInfo();
                    
                    showToast('Bio updated successfully', 'success');
                    
                } catch (error) {
                    console.error('Error updating bio:', error);
                    showToast('Failed to update bio', 'error');
                }
            }
            
            // âœ… DELETE ACCOUNT
            async function deleteAccount() {
                if (isDeleting || !currentUser) return;
                
                isDeleting = true;
                
                try {
                    // Update button state
                    document.getElementById('delete-account-btn').disabled = true;
                    document.getElementById('delete-account-btn').innerHTML = 
                        '<i class="fas fa-spinner fa-spin"></i> Deleting...';
                    
                    // Sign out user
                    await supabase.signOut();
                    
                    // Show success message
                    showToast('Account deletion initiated. You have been signed out.', 'success');
                    
                    // Redirect to login page after delay
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 2000);
                    
                } catch (error) {
                    console.error('Error deleting account:', error);
                    showToast('Failed to delete account. Please contact support.', 'error');
                    
                    // Reset button
                    document.getElementById('delete-account-btn').disabled = false;
                    document.getElementById('delete-account-btn').innerHTML = 
                        '<i class="fas fa-trash-alt"></i> Delete My Account';
                    
                    isDeleting = false;
                }
            }
            
            // âœ… SHOW TEST DATA (for development)
            function showTestData() {
                currentUser = {
                    id: 'test-user-123',
                    email: 'user@example.com',
                    user_metadata: { full_name: 'Test User' }
                };
                
                userProfile = {
                    full_name: 'Test User',
                    bio: 'This is a test bio for demonstration purposes.',
                    avatar_url: 'https://images.unsplash.com/photo-1633332755192-727a05c4013d?w=400&h=400&fit=crop'
                };
                
                favorites = [
                    {
                        id: 1,
                        title: 'Test Favorite Video',
                        thumbnail_url: 'https://images.unsplash.com/photo-1574717024653-61fd2cf4d44d?w=400&h=225&fit=crop'
                    }
                ];
                
                watchHistory = [
                    {
                        id: 2,
                        title: 'Test History Video',
                        thumbnail_url: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=225&fit=crop'
                    }
                ];
                
                // Update UI with test data
                updateUserInfo();
                updateFavorites();
                updateWatchHistory();
            }
            
            // âœ… INITIALIZE PROFILE SCREEN
            async function initializeProfileScreen() {
                try {
                    setLoading(true, 'Loading Profile...');
                    
                    // Load user data
                    await loadUserData();
                    
                    // Setup event listeners
                    setupEventListeners();
                    
                    // Hide loading
                    setLoading(false);
                    
                    console.log('âœ… Profile screen initialized successfully');
                    
                } catch (error) {
                    console.error('âŒ Error initializing profile screen:', error);
                    showToast('Failed to initialize profile', 'error');
                    setLoading(false);
                }
            }
            
            // âœ… SETUP EVENT LISTENERS
            function setupEventListeners() {
                // Edit bio button
                document.getElementById('edit-bio-btn').addEventListener('click', () => {
                    const currentBio = userProfile?.bio || '';
                    const bioTextarea = document.getElementById('bio-textarea');
                    const bioCounter = document.getElementById('bio-counter');
                    
                    bioTextarea.value = currentBio;
                    bioCounter.textContent = currentBio.length;
                    
                    // Update counter as user types
                    bioTextarea.addEventListener('input', () => {
                        bioCounter.textContent = bioTextarea.value.length;
                    });
                    
                    showModal(bioModal, true);
                });
                
                // Save bio button
                document.getElementById('save-bio-btn').addEventListener('click', () => {
                    const newBio = document.getElementById('bio-textarea').value.trim();
                    if (newBio) {
                        updateBio(newBio);
                    }
                    showModal(bioModal, false);
                });
                
                // Cancel bio button
                document.getElementById('cancel-bio-btn').addEventListener('click', () => {
                    showModal(bioModal, false);
                });
                
                // Edit avatar button
                document.getElementById('edit-avatar-btn').addEventListener('click', () => {
                    showModal(avatarModal, true);
                });
                
                // Cancel avatar button
                document.getElementById('cancel-avatar-btn').addEventListener('click', () => {
                    showModal(avatarModal, false);
                });
                
                // Camera option
                document.getElementById('camera-option').addEventListener('click', () => {
                    showToast('Camera upload coming soon!', 'info');
                    showModal(avatarModal, false);
                });
                
                // Gallery option
                document.getElementById('gallery-option').addEventListener('click', () => {
                    showToast('Gallery upload coming soon!', 'info');
                    showModal(avatarModal, false);
                });
                
                // Delete account button
                document.getElementById('delete-account-btn').addEventListener('click', () => {
                    showModal(deleteModal, true);
                });
                
                // Cancel delete button
                document.getElementById('cancel-delete-btn').addEventListener('click', () => {
                    showModal(deleteModal, false);
                });
                
                // Confirm delete button
                document.getElementById('confirm-delete-btn').addEventListener('click', () => {
                    showModal(deleteModal, false);
                    deleteAccount();
                });
                
                // Email settings
                document.getElementById('email-settings').addEventListener('click', (e) => {
                    e.preventDefault();
                    showToast('Email settings coming soon!', 'info');
                });
                
                // Close modals on background click
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            showModal(modal, false);
                        }
                    });
                });
            }
            
            // Initialize the app
            await initializeProfileScreen();
        });
    </script>
</body>
</html>
