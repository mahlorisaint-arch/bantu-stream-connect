<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bantu Stream Connect — Blog Post</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <link href="assets/css/bantu-global.css" rel="stylesheet" />
  <style>
    .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 1s forwards; }
    .fade-in-delay-1{animation-delay:.3s} .fade-in-delay-2{animation-delay:.6s}
    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    .prose p { margin-bottom: 1rem; }
  </style>
</head>
<body class="bg-black text-white font-sans dark:bg-black dark:text-white">

  <!-- Navbar -->
  <header class="bg-black bg-opacity-80 backdrop-blur-md fixed w-full z-50">
    <div class="container mx-auto flex justify-between items-center h-16 px-4 sm:px-6 lg:px-8">
      <div class="flex items-center space-x-2">
        <a href="index.html"><img src="assets/bsc-logo.png" alt="BSC Logo" class="h-10 w-auto"></a>
        <span class="font-bold text-xl">Bantu Stream Connect</span>
      </div>
      <nav class="hidden md:flex space-x-6 items-center">
        <a href="index.html" class="hover:text-blue-500 transition">Home</a>
        <a href="creators.html" class="hover:text-blue-500 transition">Creators</a>
        <a href="users.html" class="hover:text-blue-500 transition">Users</a>
        <a href="empowerment.html" class="hover:text-blue-500 transition">Empowerment</a>
        <a href="blog.html" class="text-blue-500 font-semibold">Blog</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative h-[40vh] flex items-center justify-center text-center mt-16">
    <img id="hero-img" src="assets/blog/blog-1.png" alt="Blog Hero" class="absolute inset-0 w-full h-full object-cover opacity-40">
    <div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/80 to-black/95"></div>
    <div class="relative z-10 px-4 sm:px-6 lg:px-8 fade-in fade-in-delay-1">
      <h1 id="post-title" class="text-4xl sm:text-5xl md:text-6xl font-bold mb-4">Loading...</h1>
      <p id="post-excerpt" class="text-lg sm:text-xl max-w-2xl mx-auto"></p>
    </div>
  </section>

  <!-- Content -->
  <section class="py-20 bg-gray-900">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 fade-in fade-in-delay-2">
      <div id="post-content" class="prose prose-invert max-w-none"></div>
      <div class="mt-10 text-center">
        <a href="blog.html" class="button-primary">Back to blog</a>
      </div>
    </div>
  </section>

  <footer class="bg-black bg-opacity-80 text-gray-400">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center py-8">
      <img src="assets/bsc-logo.png" alt="BSC Logo" class="h-12 mx-auto mb-4">
      <p class="mb-4">© 2025 Bantu Stream Connect. All rights reserved.</p>
    </div>
  </footer>

<script>
(async function () {
  // Helpful debug info
  console.log("post-1.html booting — attempting to load data/posts.json");

  // determine possible keys used in posts.json
  function tryFindPost(posts, match) {
    if (!posts) return null;
    // exact url match
    let p = posts.find(x => x.url && x.url === match);
    if (p) return p;
    // try id match if match numeric
    if (!isNaN(Number(match))) {
      p = posts.find(x => x.id && Number(x.id) === Number(match));
      if (p) return p;
    }
    // try matching by slug/title fallback
    p = posts.find(x => x.title && x.title.toLowerCase().includes(String(match).toLowerCase()));
    return p || null;
  }

  // choose candidate keys to search
  const pathname = window.location.pathname.split("/").pop(); // e.g., 'post-1.html'
  const searchParams = new URLSearchParams(window.location.search);
  const idParam = searchParams.get('id'); // e.g., ?id=1
  console.log("Detected pathname:", pathname, "query id:", idParam);

  try {
    const res = await fetch('data/posts.json');
    if (!res.ok) throw new Error('posts.json fetch failed: ' + res.status);
    const posts = await res.json();
    console.log("Loaded posts.json, posts length:", posts.length || 0);

    // try matching strategies in order
    let post = null;
    post = tryFindPost(posts, pathname);
    if (!post && idParam) post = tryFindPost(posts, idParam);
    if (!post) post = posts[0]; // fallback: use first post so page never empty

    if (!post) {
      document.getElementById('post-title').textContent = 'Post Not Found';
      document.getElementById('post-content').innerHTML = '<p class="text-gray-400">The requested blog post could not be found.</p>';
      console.warn("No post found in posts.json using pathname or id; posts array:", posts);
      return;
    }

    console.log("Rendering post:", post.title || post.id);

    // fill content
    document.getElementById('post-title').textContent = post.title || 'Untitled';
    document.getElementById('post-excerpt').textContent = post.excerpt || '';
    if (post.image) {
      const hero = document.getElementById('hero-img');
      hero.src = post.image;
    }

    // If fullContent exists, support both HTML and plain text
    let html = '';
    if (post.fullContent) {
      // if looks like HTML (contains <p>), use as-is, else convert line breaks
      if (post.fullContent.trim().startsWith('<')) {
        html = post.fullContent;
      } else {
        html = '<p>' + post.fullContent.replace(/\n\n/g, '</p><p>').replace(/\n/g, '<br>') + '</p>';
      }
    } else if (post.content) {
      // older field name support
      if (Array.isArray(post.content)) {
        html = post.content.map(p => `<p>${p}</p>`).join('');
      } else {
        html = String(post.content).replace(/\n\n/g, '</p><p>').replace(/\n/g, '<br>');
      }
    } else {
      html = '<p class="text-gray-400">Full content unavailable for this post.</p>';
    }

    document.getElementById('post-content').innerHTML = html;

  } catch (err) {
    console.error("Error loading post:", err);
    document.getElementById('post-title').textContent = 'Error Loading Post';
    document.getElementById('post-content').innerHTML = '<p class="text-gray-400">There was an error loading the blog post. Check console for details.</p>';
  }
})();
</script>
</body>
</html>
