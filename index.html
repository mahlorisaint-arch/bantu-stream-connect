<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bantu Stream Connect — Landing Page</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="assets/css/bantu-global.css" rel="stylesheet" />
  <style>
    body { background: black; color: white; font-family: 'Poppins', sans-serif; }
    .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 1s forwards; }
    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
    .gradient-text { background: linear-gradient(to right, #00aaff, #0077ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .focus-ring:focus { outline: 2px solid rgba(0,163,255,0.28); outline-offset: 2px; }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center text-center bg-black text-white">

  <!-- Hero Section -->
  <section class="relative px-6 py-20 max-w-3xl mx-auto fade-in">
    <img src="assets/bsc-logo.png" alt="Bantu Stream Logo" class="h-16 mx-auto mb-6">
    <h1 class="text-4xl sm:text-5xl font-bold mb-4 gradient-text">Join the Movement</h1>
    <p class="text-lg sm:text-xl text-gray-300 mb-6">
      Be among the first to join <span class="font-semibold text-blue-400">Bantu Stream Connect</span>.
    </p>
  </section>

  <!-- Hero Signup Form -->
  <section class="bg-gray-900 bg-opacity-70 backdrop-blur-md rounded-2xl shadow-xl p-8 mx-6 max-w-xl fade-in mt-4">
    <h2 class="text-2xl font-bold mb-4 text-blue-400">Sign Up Now</h2>
    <form id="hero-signup" class="flex flex-col gap-3">
      <input name="name" placeholder="Full Name" required class="border p-2 rounded w-full focus-ring"/>
      <input type="email" name="email" placeholder="Email Address" required class="border p-2 rounded w-full focus-ring"/>
      <select name="user_type" required class="border p-2 rounded w-full focus-ring">
        <option value="">Select Type</option>
        <option value="creator">Creator</option>
        <option value="user">User</option>
      </select>
      <input type="text" name="referred_by" placeholder="Referral code (optional)" class="border p-2 rounded w-full focus-ring"/>
      <button type="submit" class="bg-blue-600 text-white px-4 py-2 mt-2 rounded w-full hover:bg-blue-700 transition">Join Now</button>
      <div id="hero-signup-message" class="mt-2 text-sm"></div>
    </form>
  </section>

  <!-- Optional Referral Teaser -->
  <section class="mt-10 fade-in">
    <p class="text-gray-400">Have a referral code? Enter it during signup to earn rewards.</p>
  </section>

  <!-- Full Signup Form + Referral Section -->
  <section class="mt-10 card p-6 rounded-md fade-in">
    <h3 class="text-xl font-bold">Join & Refer — Grow with Us</h3>
    <p class="mt-2 text-slate-300">Sign up and get a unique referral link. Refer friends to move up the waitlist and unlock rewards.</p>
    <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="card p-4 rounded-md">
        <h4 class="font-semibold">Sign up</h4>
        <form id="full-signup" class="mt-3 flex flex-col gap-3">
          <input name="name" placeholder="Full name" required class="px-3 py-2 rounded-md bg-transparent border border-slate-700 focus-ring" />
          <input name="email" type="email" placeholder="Email address" required class="px-3 py-2 rounded-md bg-transparent border border-slate-700 focus-ring" />
          <select name="user_type" required class="px-3 py-2 rounded-md bg-transparent border border-slate-700 focus-ring">
            <option value="user">User / Viewer</option>
            <option value="creator">Creator</option>
          </select>
          <input name="referred_by" placeholder="Referral code (optional)" class="px-3 py-2 rounded-md bg-transparent border border-slate-700 focus-ring" />
          <button type="submit" class="mt-2 px-4 py-2 rounded-md" style="background:linear-gradient(90deg,#00aaff,#0077ff); color:#021026">Sign Up & Get Referral Link</button>
          <div id="full-signup-message" class="mt-2 text-sm"></div>
        </form>
      </div>
      <div class="card p-4 rounded-md">
        <h4 class="font-semibold">How referrals work</h4>
        <ol class="mt-2 text-slate-400 list-decimal list-inside space-y-1">
          <li>Sign up and get your unique referral link.</li>
          <li>Share it — friends sign up using your link.</li>
          <li>Earn rewards for every 3 successful referrals.</li>
        </ol>
        <p class="mt-3 text-sm text-slate-400">Referral links are tracked and stored in Supabase. Rewards will be applied after verification.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="mt-16 py-8 text-gray-500 text-sm fade-in">
    <p>© 2025 Bantu Stream Connect. Made with African pride.</p>
  </footer>

  <!-- ================= MODULE SCRIPTS ================= -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const SUPABASE_URL = 'https://ydnxqnbjoshvxteevemc.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U';
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    function generateReferralCode(length = 6) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      return Array.from({length}, () => chars[Math.floor(Math.random()*chars.length)]).join('');
    }

    async function handleSignup(formId, messageId) {
      const form = document.getElementById(formId);
      const messageEl = document.getElementById(messageId);

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        messageEl.textContent = '';
        const formData = new FormData(form);
        const name = formData.get('name');
        const email = formData.get('email');
        const user_type = formData.get('user_type');
        const referred_by = formData.get('referred_by') || null;
        const referral_code = generateReferralCode();

        try {
          const { data, error } = await supabase
            .from('signups')
            .insert([{ name, email, user_type, referral_code, referred_by }]);

          if (error) {
            console.error(error);
            messageEl.textContent = 'There was an error submitting your sign-up. Please try again.';
            return;
          }

          messageEl.textContent = `Thank you! Your referral code is ${referral_code}`;
          form.reset();
        } catch(err) {
          console.error(err);
          messageEl.textContent = 'There was an error submitting your sign-up. Please try again.';
        }
      });
    }

    handleSignup('hero-signup', 'hero-signup-message');
    handleSignup('full-signup', 'full-signup-message');
  </script>
</body>
</html>
