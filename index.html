<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Bantu Stream Connect ‚Äî Watch Amazing Content</title>
    <meta name="description" content="Watch amazing content from African creators. Stream videos, music, podcasts, and more on Bantu Stream Connect." />
    <meta property="og:title" content="Bantu Stream Connect ‚Äî The Home for African Film, Music & Creativity" />
    <meta property="og:description" content="Watch amazing content from African creators. Stream videos, music, podcasts, and more on Bantu Stream Connect." />
    <meta property="og:image" content="/assets/images/og-teaser.jpg" />
    <meta name="theme-color" content="#071428" />
    <link rel="icon" href="assets/bsc-icon.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="/assets/css/bantu-global.css" rel="stylesheet" />
    
    <!-- Home Feed Specific Styles -->
    <style>
        :root{ 
            --accent: #00a3ff; 
            --accent-2: #00ffd5; 
            --muted: #9aa9bf; 
            --bg: #05060a; 
        }
        .glass { 
            background: rgba(255,255,255,0.03); 
        }
        .card { 
            background: #0b1220; 
            border: 1px solid rgba(255,255,255,0.03); 
        }
        .focus-ring:focus { 
            outline: 2px solid rgba(0,163,255,0.28); 
            outline-offset: 2px; 
        }
        
        /* Loading Indicator */
        .loading-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #001F54 0%, #0A0E3F 50%, #000000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #4dabf7;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Toast Notifications */
        .error-toast, .success-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            z-index: 10000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        }
        
        .error-toast {
            background: linear-gradient(135deg, #ff6b6b 0%, #c92a2a 100%);
        }
        
        .success-toast {
            background: linear-gradient(135deg, #51cf66 0%, #2b8a3e 100%);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Content Card Styles */
        .content-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border-color: rgba(255, 255, 255, 0.3) !important;
        }
        
        .content-thumbnail {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }
        
        .content-thumbnail img {
            transition: transform 0.3s ease;
        }
        
        .content-card:hover .content-thumbnail img {
            transform: scale(1.05);
        }
        
        .thumbnail-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 50%, rgba(0, 0, 0, 0.5) 100%);
        }
        
        /* Category Tabs */
        .category-tabs-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .category-tabs-container::-webkit-scrollbar {
            display: none;
        }
        
        .category-tab {
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .category-tab:hover {
            background: rgba(255, 255, 255, 0.2) !important;
            transform: translateY(-2px);
        }
        
        .category-tab.active {
            background: linear-gradient(135deg, #4dabf7 0%, #748ffc 100%) !important;
            border-color: transparent !important;
            box-shadow: 0 4px 15px rgba(77, 171, 247, 0.4);
        }
        
        /* Creator Button */
        .creator-btn {
            background: linear-gradient(135deg, #4dabf7 0%, #748ffc 100%) !important;
            transition: all 0.3s ease;
        }
        
        .creator-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(77, 171, 247, 0.4);
        }
        
        /* Scrollable Content Carousels */
        .content-carousel {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .content-carousel::-webkit-scrollbar {
            height: 6px;
        }
        
        .content-carousel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }
        
        .content-carousel::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
        
        .content-carousel::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }
    </style>
    
    <!-- Analytics scripts -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZXZCYRJYV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZXZCYRJYV');
    </script>
    
    <!-- Meta Pixel -->
    <script>
        !function(f,b,e,v,n,t,s) {
            if(f.fbq)return;n=f.fbq=function(){n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments);};
            if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0'; n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);
        }(window, document,'script', 'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '1331891561809016');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1331891561809016&ev=PageView&noscript=1" />
    </noscript>
</head>
<body class="bg-gradient-to-b from-[#02030a] to-[#071428] text-slate-100 antialiased">
    <!-- Loading Indicator -->
    <div id="loading-indicator" class="loading-indicator hidden">
        <div class="loading-spinner"></div>
        <p class="mt-4 text-white">Loading content...</p>
    </div>

    <div class="max-w-6xl mx-auto px-5 py-4">
        
        <!-- Header - Modified for Home Feed -->
        <header class="flex items-center justify-between gap-4 mb-6">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background:linear-gradient(135deg,var(--accent),var(--accent-2));">
                    <img src="assets/bsc-icon.png" alt="Bantu Stream Connect" class="w-8 h-8">
                </div>
                <div>
                    <div class="font-extrabold text-lg">Bantu Stream Connect</div>
                    <div class="text-sm text-slate-400">Watch amazing content</div>
                </div>
            </div>
            
            <!-- Search and Profile Actions -->
            <div class="flex items-center gap-4">
                <!-- Search Button -->
                <button id="search-btn" class="p-2 rounded-full border border-slate-600 hover:border-white transition focus-ring">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                </button>
                
                <!-- Profile Button -->
                <button id="profile-btn" class="p-2 rounded-full border border-slate-600 hover:border-white transition focus-ring">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Category Tabs -->
        <div class="category-tabs-container mb-6">
            <div id="category-tabs" class="flex gap-2 pb-2">
                <!-- Categories will be loaded dynamically -->
            </div>
        </div>

        <!-- Main Content Area -->
        <main>
            <!-- Hero Banner (optional - can be removed) -->
            <div class="card p-6 rounded-lg mb-8">
                <h1 class="text-2xl md:text-3xl font-bold mb-4">Welcome to Bantu Stream Connect</h1>
                <p class="text-slate-300 mb-6">Discover amazing content from creators across Africa</p>
                <button id="browse-all-btn" class="px-5 py-3 rounded-lg font-bold" style="background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021026">
                    Browse All Content
                </button>
            </div>

            <!-- Content Sections -->
            <div id="content-sections">
                <!-- Content will be loaded dynamically -->
            </div>
        </main>

        <!-- Footer -->
        <footer class="mt-12 py-6 text-slate-400 border-t border-slate-800">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <div class="font-bold">Bantu Stream Connect</div>
                    <div class="text-sm">Built in South Africa. ¬© 2025 Bantu Stream Connect</div>
                </div>
                <div class="flex gap-4 text-sm">
                    <a href="/creators" class="hover:text-white">For Creators</a>
                    <a href="/empowerment" class="hover:text-white">Empowerment</a>
                    <a href="/blog" class="hover:text-white">Blog</a>
                    <a href="/privacy" class="hover:text-white">Privacy</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Import Supabase -->
    <script type="module">
        // Import Supabase
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'

        // ‚úÖ Use the same Supabase credentials from your mobile app
        const SUPABASE_URL = 'https://ydnxqnbjoshvxteevemc.supabase.co'
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnhxbmJqb3Nodnh0ZWV2ZW1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc2MzI0OTMsImV4cCI6MjA3MzIwODQ5M30.NlaCCnLPSz1mM7AFeSlfZQ78kYEKUMh_Fi-7P_ccs_U'

        // Create Supabase client
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY)

        // Make it globally available
        window.supabase = supabase

        // Check auth state
        supabase.auth.onAuthStateChange((event, session) => {
            console.log('Auth state changed:', event)
            if (event === 'SIGNED_IN') {
                console.log('User signed in:', session?.user?.email)
            } else if (event === 'SIGNED_OUT') {
                console.log('User signed out')
            }
        })
    </script>

    <!-- Home Feed JavaScript (Embedded in the HTML) -->
    <script type="module">
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Home Feed Initializing...')
            
            // Get DOM elements
            const categoryTabsContainer = document.getElementById('category-tabs')
            const contentSectionsContainer = document.getElementById('content-sections')
            const loadingIndicator = document.getElementById('loading-indicator')
            
            // State variables
            let allContentData = []
            let filteredContentData = []
            let selectedCategoryIndex = 0
            let isLoading = false
            
            // Categories (same as mobile app)
            const categories = [
                'All',
                'Movies',
                'TV Shows',
                'Documentaries',
                'Kids',
                'Sports',
                'News',
                'Music',
                'Videos',
                'Podcasts',
                'Skits',
                'Content',
                'STEM'
            ]
            
            // ‚úÖ SET LOADING STATE
            function setLoading(loading) {
                isLoading = loading
                if (loadingIndicator) {
                    loadingIndicator.classList.toggle('hidden', !loading)
                }
            }
            
            // ‚úÖ SHOW ERROR TOAST
            function showError(message) {
                const toast = document.createElement('div')
                toast.className = 'error-toast'
                toast.textContent = message
                document.getElementById('toast-container').appendChild(toast)
                
                setTimeout(() => {
                    toast.remove()
                }, 5000)
            }
            
            // ‚úÖ SHOW SUCCESS TOAST
            function showSuccess(message) {
                const toast = document.createElement('div')
                toast.className = 'success-toast'
                toast.textContent = message
                document.getElementById('toast-container').appendChild(toast)
                
                setTimeout(() => {
                    toast.remove()
                }, 3000)
            }
            
            // ‚úÖ FETCH HOME FEED CONTENT
            async function getHomeFeedContent(limit = 50, category = null) {
                try {
                    let query = supabase
                        .from('Content')
                        .select(`
                            id,
                            title,
                            description,
                            thumbnail_url,
                            media_type,
                            file_url,
                            created_at,
                            user_id,
                            creator_id,
                            genre,
                            status,
                            views_count,
                            likes_count,
                            user_profiles!user_id(
                                full_name,
                                username,
                                avatar_url
                            )
                        `)
                        .eq('status', 'published')
                        .order('created_at', { ascending: false })
                        .limit(limit)

                    if (category && category !== 'All') {
                        query = query.eq('genre', category)
                    }

                    const { data, error } = await query

                    if (error) throw error

                    // Process data with creator names
                    const processedData = data.map(item => {
                        let creatorDisplayName = 'Content Creator'
                        
                        if (item.user_profiles) {
                            creatorDisplayName = item.user_profiles.full_name || 
                                               item.user_profiles.username || 
                                               'Content Creator'
                        }

                        return {
                            id: item.id,
                            title: item.title || 'Untitled',
                            description: item.description || '',
                            thumbnail_url: item.thumbnail_url,
                            file_url: item.file_url,
                            media_type: item.media_type || 'video',
                            genre: item.genre,
                            created_at: item.created_at,
                            creator: creatorDisplayName,
                            creator_display_name: creatorDisplayName,
                            creator_id: item.creator_id,
                            user_id: item.user_id,
                            views: item.views_count || 0,
                            likes: item.likes_count || 0
                        }
                    })

                    console.log('‚úÖ Home feed loaded:', processedData.length, 'items')
                    return processedData
                } catch (error) {
                    console.error('‚ùå Error fetching home feed:', error)
                    return []
                }
            }
            
            // ‚úÖ GET MOST VIEWED CONTENT
            function getMostViewedContent(contentData = []) {
                if (contentData.length === 0) return []
                
                return [...contentData]
                    .sort((a, b) => (b.views || 0) - (a.views || 0))
                    .slice(0, 10)
            }
            
            // ‚úÖ GET MOST LIKED CONTENT
            function getMostLikedContent(contentData = []) {
                if (contentData.length === 0) return []
                
                return [...contentData]
                    .sort((a, b) => (b.likes || 0) - (a.likes || 0))
                    .slice(0, 10)
            }
            
            // ‚úÖ GET TRENDING CONTENT
            function getTrendingContent(contentData = []) {
                if (contentData.length === 0) return []
                
                const oneWeekAgo = new Date()
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7)
                
                const recentContent = contentData.filter(item => {
                    try {
                        const createdAt = new Date(item.created_at)
                        return createdAt >= oneWeekAgo
                    } catch {
                        return false
                    }
                })
                
                return recentContent
                    .sort((a, b) => {
                        const aScore = (a.views || 0) + ((a.likes || 0) * 2)
                        const bScore = (b.views || 0) + ((b.likes || 0) * 2)
                        return bScore - aScore
                    })
                    .slice(0, 10)
            }
            
            // ‚úÖ INITIALIZE HOME FEED
            async function initializeHomeFeed() {
                try {
                    setLoading(true)
                    
                    // Load content
                    allContentData = await getHomeFeedContent(100)
                    filteredContentData = allContentData
                    
                    // Render UI
                    renderCategoryTabs()
                    renderContentSections()
                    
                    setLoading(false)
                    
                } catch (error) {
                    console.error('‚ùå Error initializing home feed:', error)
                    showError('Failed to load content. Please try again.')
                    setLoading(false)
                }
            }
            
            // ‚úÖ RENDER CATEGORY TABS
            function renderCategoryTabs() {
                if (!categoryTabsContainer) return
                
                categoryTabsContainer.innerHTML = categories.map((category, index) => `
                    <button class="category-tab px-4 py-2 rounded-full border border-slate-700 text-sm ${
                        index === selectedCategoryIndex ? 'active text-white' : 'text-slate-300'
                    }" 
                            data-index="${index}"
                            data-category="${category}">
                        ${category}
                    </button>
                `).join('')
                
                // Add click handlers
                document.querySelectorAll('.category-tab').forEach(button => {
                    button.addEventListener('click', () => {
                        const index = parseInt(button.dataset.index)
                        onCategoryChanged(index)
                    })
                })
            }
            
            // ‚úÖ RENDER CONTENT SECTIONS
            function renderContentSections() {
                if (!contentSectionsContainer) return
                
                contentSectionsContainer.innerHTML = `
                    <!-- Latest Uploads -->
                    <section class="mb-10">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold">Latest Uploads</h2>
                            <button class="see-all-btn text-sm text-blue-400 hover:text-blue-300" data-action="browse-all">
                                See All
                            </button>
                        </div>
                        <div class="content-carousel flex gap-4 pb-4">
                            ${renderContentCards(filteredContentData.slice(0, 10))}
                        </div>
                    </section>
                    
                    <!-- Most Viewed -->
                    <section class="mb-10">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold">Most Viewed</h2>
                            <button class="see-all-btn text-sm text-blue-400 hover:text-blue-300" data-action="browse-all">
                                See All
                            </button>
                        </div>
                        <div class="content-carousel flex gap-4 pb-4">
                            ${renderContentCards(getMostViewedContent(filteredContentData))}
                        </div>
                    </section>
                    
                    <!-- Most Liked -->
                    <section class="mb-10">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold">Most Liked</h2>
                            <button class="see-all-btn text-sm text-blue-400 hover:text-blue-300" data-action="browse-all">
                                See All
                            </button>
                        </div>
                        <div class="content-carousel flex gap-4 pb-4">
                            ${renderContentCards(getMostLikedContent(filteredContentData))}
                        </div>
                    </section>
                    
                    <!-- Trending Now -->
                    <section class="mb-10">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold">Trending Now</h2>
                            <button class="see-all-btn text-sm text-blue-400 hover:text-blue-300" data-action="browse-all">
                                See All
                            </button>
                        </div>
                        <div class="content-carousel flex gap-4 pb-4">
                            ${renderContentCards(getTrendingContent(filteredContentData))}
                        </div>
                    </section>
                    
                    <!-- Category-specific content -->
                    ${selectedCategoryIndex !== 0 ? `
                        <section class="mb-10">
                            <div class="flex justify-between items-center mb-4">
                                <h2 class="text-xl font-bold">${categories[selectedCategoryIndex]}</h2>
                                <button class="see-all-btn text-sm text-blue-400 hover:text-blue-300" data-action="browse-all">
                                    See All
                                </button>
                            </div>
                            <div class="content-carousel flex gap-4 pb-4">
                                ${filteredContentData.length > 0 
                                    ? renderContentCards(filteredContentData.slice(0, 10))
                                    : renderEmptyCategoryState(categories[selectedCategoryIndex])
                                }
                            </div>
                        </section>
                    ` : ''}
                    
                    <!-- Browse All CTA -->
                    <div class="text-center mt-12 mb-8">
                        <button id="browse-all-cta" class="px-8 py-4 rounded-lg font-bold text-lg" style="background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021026">
                            Browse All Content
                        </button>
                    </div>
                `
                
                // Add event listeners
                setupContentCardListeners()
                setupEventListeners()
            }
            
            // ‚úÖ RENDER CONTENT CARDS
            function renderContentCards(contentItems) {
                if (!contentItems || contentItems.length === 0) {
                    return '<div class="text-slate-400 py-8 text-center">No content available</div>'
                }
                
                return contentItems.map(content => `
                    <div class="content-card card p-3 rounded-lg flex-none w-48" data-content-id="${content.id}">
                        <div class="content-thumbnail mb-3 h-32">
                            <img src="${content.thumbnail_url || 'assets/bsc-icon.png'}" 
                                 alt="${content.title}"
                                 class="w-full h-full object-cover rounded"
                                 loading="lazy">
                            <div class="thumbnail-overlay"></div>
                            <button class="share-btn absolute top-2 right-2 p-1.5 rounded-full bg-black bg-opacity-60 border border-slate-600 text-amber-400 hover:bg-opacity-80 transition"
                                    data-content='${JSON.stringify(content).replace(/'/g, "&#39;")}'>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13"/>
                                </svg>
                            </button>
                        </div>
                        <div>
                            <h3 class="font-semibold text-sm mb-2 line-clamp-2 h-10" title="${content.title}">
                                ${content.title.length > 50 ? content.title.substring(0, 50) + '...' : content.title}
                            </h3>
                            <div class="flex justify-between items-center">
                                <button class="creator-btn px-3 py-1.5 rounded-md text-xs font-medium text-white flex items-center gap-1"
                                        data-creator-id="${content.creator_id}"
                                        data-creator-name="${content.creator}">
                                    <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    ${content.creator.length > 12 ? content.creator.substring(0, 12) + '...' : content.creator}
                                </button>
                                <div class="text-xs text-slate-400">
                                    ${content.views.toLocaleString()} views
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('')
            }
            
            // ‚úÖ RENDER EMPTY CATEGORY STATE
            function renderEmptyCategoryState(category) {
                const icon = category === 'Kids' ? 'üë∂' : 'üîç'
                
                return `
                    <div class="text-center py-12 text-slate-400 w-48 flex-none">
                        <div class="text-4xl mb-3">${icon}</div>
                        <h3 class="font-semibold text-white mb-1">No ${category} Content Yet</h3>
                        <p class="text-sm">Be the first to upload ${category.toLowerCase()} content!</p>
                    </div>
                `
            }
            
            // ‚úÖ CATEGORY CHANGE HANDLER
            function onCategoryChanged(index) {
                selectedCategoryIndex = index
                const selectedCategory = categories[index]
                
                console.log(`üéØ Category changed to: ${selectedCategory}`)
                
                // Update active tab
                document.querySelectorAll('.category-tab').forEach((btn, i) => {
                    btn.classList.toggle('active', i === index)
                    btn.classList.toggle('text-white', i === index)
                    btn.classList.toggle('text-slate-300', i !== index)
                })
                
                // Filter content
                if (selectedCategory === 'All') {
                    filteredContentData = allContentData
                } else {
                    filteredContentData = allContentData.filter(item => {
                        const itemGenre = item.genre
                        if (!itemGenre) return false
                        
                        const normalizedItemGenre = itemGenre.toLowerCase().trim()
                        const normalizedSelectedCategory = selectedCategory.toLowerCase().trim()
                        
                        if (selectedCategory === 'Kids') {
                            return normalizedItemGenre === 'kids'
                        }
                        
                        return normalizedItemGenre === normalizedSelectedCategory
                    })
                }
                
                console.log(`üìä Filtered content count: ${filteredContentData.length}`)
                
                // Re-render content sections
                renderContentSections()
            }
            
            // ‚úÖ SETUP CONTENT CARD LISTENERS
            function setupContentCardListeners() {
                // Content card clicks
                document.querySelectorAll('.content-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        // Don't trigger if clicking on share or creator button
                        if (e.target.closest('.share-btn') || e.target.closest('.creator-btn')) {
                            return
                        }
                        
                        const contentId = card.dataset.contentId
                        const content = allContentData.find(c => c.id === parseInt(contentId))
                        if (content) {
                            navigateToVideoPlayer(content)
                        }
                    })
                })
                
                // Share buttons
                document.querySelectorAll('.share-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation()
                        const content = JSON.parse(btn.dataset.content.replace(/&#39;/g, "'"))
                        shareContent(content)
                    })
                })
                
                // Creator buttons
                document.querySelectorAll('.creator-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation()
                        const creatorId = btn.dataset.creatorId
                        const creatorName = btn.dataset.creatorName
                        navigateToCreatorChannel(creatorId, creatorName)
                    })
                })
            }
            
            // ‚úÖ SETUP EVENT LISTENERS
            function setupEventListeners() {
                // Search button
                const searchBtn = document.getElementById('search-btn')
                if (searchBtn) {
                    searchBtn.addEventListener('click', handleSearch)
                }
                
                // Profile button
                const profileBtn = document.getElementById('profile-btn')
                if (profileBtn) {
                    profileBtn.addEventListener('click', handleProfile)
                }
                
                // Browse all buttons
                document.querySelectorAll('[data-action="browse-all"], #browse-all-btn, #browse-all-cta').forEach(btn => {
                    btn.addEventListener('click', handleBrowseAll)
                })
            }
            
            // ‚úÖ EVENT HANDLERS
            function handleSearch() {
                console.log('üîç Search clicked')
                // Navigate to search page or open search modal
                window.location.href = 'search.html'
            }
            
            function handleBrowseAll() {
                console.log('üìö Browse All clicked')
                window.location.href = 'content-library.html'
            }
            
            function handleProfile() {
                const { data: { user } } = supabase.auth.getUser()
                if (user) {
                    window.location.href = `creator-dashboard.html?userId=${user.id}`
                } else {
                    window.location.href = 'login.html'
                }
            }
            
            function navigateToCreatorChannel(creatorId, creatorName) {
                if (!creatorId) {
                    showError(`Cannot view ${creatorName}'s channel - missing creator information`)
                    return
                }
                
                console.log(`üîÑ Navigating to creator channel: ${creatorId} (${creatorName})`)
                window.location.href = `creator-channel.html?creatorId=${creatorId}`
            }
            
            function navigateToVideoPlayer(content) {
                if (!content.id || !content.file_url) {
                    showError('Unable to play content: Missing required data')
                    return
                }
                
                const params = new URLSearchParams({
                    id: content.id,
                    title: content.title || 'Untitled',
                    description: content.description || '',
                    file_url: content.file_url,
                    thumbnail_url: content.thumbnail_url,
                    media_type: content.media_type || 'video',
                    creator: content.creator,
                    creator_id: content.creator_id,
                    user_id: content.user_id,
                    created_at: content.created_at,
                    views: content.views || 0,
                    likes: content.likes || 0
                })
                
                window.location.href = `video-player.html?${params.toString()}`
            }
            
            function shareContent(content) {
                const title = content.title || 'Amazing Content'
                const creatorName = content.creator || 'Bantu Creator'
                const contentId = content.id || 'unknown'
                
                const shareLink = `https://bantustreamconnect.com/content/${contentId}`
                const shareText = `Check out "${title}" by ${creatorName} on Bantu Stream Connect! üöÄ\n\n${shareLink}\n\nDiscover amazing content and connect with creators from around the world.\n\n#BantuStreamConnect #ContentCreation`
                
                if (navigator.share) {
                    navigator.share({
                        title: 'Amazing content on Bantu Stream Connect',
                        text: shareText,
                        url: shareLink
                    })
                } else {
                    // Fallback: copy to clipboard
                    navigator.clipboard.writeText(shareText).then(() => {
                        showSuccess('Link copied to clipboard!')
                    })
                }
            }
            
            // Initialize the home feed
            await initializeHomeFeed()
        })
    </script>
</body>
</html>
